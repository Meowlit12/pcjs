(function(){/*
 https://www.pcjs.org/modules/shared/lib/dumpapi.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/reportapi.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/userapi.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/keys.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/strlib.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/weblib.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/cpudef.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/messages.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/state.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/embed.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/defines.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/usrlib.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/component.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/defines.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/panel.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/bus.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/memory.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/cpu.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/cpustate.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/cpuops.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/chipset.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/rom.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/ram.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/keyboard.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/video.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/serial.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/shared/lib/debugger.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/debugger.js (C) Jeff Parsons 2012-2018
 https://www.pcjs.org/modules/pc8080/lib/computer.js (C) Jeff Parsons 2012-2018
*/
var l,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ca;if("function"==typeof Object.setPrototypeOf)ca=Object.setPrototypeOf;else{var da;a:{var ea={ub:!0},fa={};try{fa.__proto__=ea;da=fa.ub;break a}catch(a){}da=!1}ca=da?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ha=ca;
function ia(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(ha)ha(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Pf=b.prototype}
for(var ja="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ka="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,la=["Math","trunc"],na=0;na<la.length-1;na++){var oa=la[na];oa in ka||(ka[oa]={});ka=ka[oa]}
var pa=la[la.length-1],qa=ka[pa],ra=qa?qa:function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var b=Math.floor(Math.abs(a));return 0>a?-b:b};ra!=qa&&null!=ra&&ja(ka,pa,{configurable:!0,writable:!0,value:ra});
var m={Ae:0,De:1,Ee:2,Fe:3,Ge:4,He:5,Ie:6,Je:7,Ke:8,Le:9,Me:10,Ne:11,Oe:12,Pe:13,Qe:14,Re:15,Se:16,Te:17,Ue:18,Ve:19,We:20,Xe:21,Ye:22,Ze:23,$e:24,af:25,bf:26,hf:27," ":32,"!":33,'"':34,"#":35,$:36,"%":37,"\x26":38,"'":39,"(":40,")":41,"*":42,"+":43,",":44,"-":45,".":46,"/":47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,";":59,"\x3c":60,"\x3d":61,"\x3e":62,"?":63,"@":64,Xa:65,Tb:66,Ub:67,Cb:68,E:69,Xb:70,Yb:71,Zb:72,$b:73,ac:74,bc:75,Eb:76,fc:77,gc:78,kc:79,lc:80,Q:81,mc:82,oc:83,pc:84,
qc:85,sc:86,tc:87,vc:88,wc:89,sb:90,"[":91,"\\":92,"]":93,"^":94,_:95,"`":96,ub:97,sd:98,vd:99,d:100,e:101,zd:102,Bd:103,Cd:104,Dd:105,Md:106,k:107,Nd:108,Pd:109,n:110,Qd:111,p:112,q:113,r:114,me:115,t:116,oe:117,pe:118,qe:119,x:120,y:121,z:122,"{":123,"|":124,"}":125,"~":126,cf:127},sa={59:186,61:187,173:189,224:91};
function ta(a,b){if(a){b||(b=10);var c,d=0<a.indexOf(",");d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);"#"==c?(b=8,c=""):"$"==c&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),"0b"==c&&d||"^B"==c?(b=2,c=""):"0o"==c||"^O"==c?(b=8,c=""):"^D"==c?(b=10,c=""):"0x"==c&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);"Y"==c||"y"==c?(b=2,c=""):"."==c?(b=10,c=""):"H"==c||"h"==c?(b=16,c=""):"K"==c?c="000":"M"==c?c="000000":"G"==c&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;10>=b&&(c=a.match(/(-?[0-9]+)B([0-9]*)/))&&
(a=c[1],e=35-((c[2]||35)&255));c=a;if(((d=b)&&10!=d?16==d?null!==c.match(/^-?[0-9a-f]+$/i):8==d?null!==c.match(/^-?[0-7]+$/):2==d&&null!==c.match(/^-?[01]+$/):null!==c.match(/^-?[0-9]+$/))&&!isNaN(f=parseInt(a,b))){e&&(0>f&&(f+=Math.pow(2,36)),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function wa(a,b,c,d,e){e=void 0===e?0:e;var f="";isNaN(a)?a=null:null!=a&&(0>a&&-1<a&&(a=-1),0>a&&(a+=Math.pow(b,c)),a>=Math.pow(b,c)&&(c=Math.ceil(Math.log(a)/Math.log(b))));for(var g=e||-1;0<c--;){g||(f=","+f,g=e);if(null==a)f="?"+f;else{var h=a%b;h+=0<=h&&9>=h?48:55;f=String.fromCharCode(h)+f;a=Math.trunc(a/b)}g--}return(void 0===d?"":d)+f}function n(a,b,c){b?9<b&&(b=9):(b=Math.abs(a),b=65535>=b?4:4294967295>=b?8:9);return wa(a,16,b,c?"0x":"")}function xa(a){return n(a,2,!0)}
function q(a){return n(a,4,!0)}function ya(a){var b=a,c=a.lastIndexOf("/");0<=c&&(b=a.substr(c+1));c=b.indexOf("\x26");0<c&&(b=b.substr(0,c));return b}function za(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase());return b}function Aa(){var a=Ca();return-1!==a.indexOf("pcjs.org",a.length-8)}function Da(a){return a.replace(/[&<>"']/g,function(a){return Ea[a]})}function Fa(a,b){return(a+"                                        ").slice(0,b)}
function Ga(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}var Ea={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#039;"},Ha={0:"NUL",1:"SOH",2:"STX",3:"ETX",4:"EOT",5:"ENQ",6:"ACK",7:"BEL",8:"BS",9:"TAB",10:"LF",11:"VT",12:"FF",13:"CR",14:"SO",15:"SI",16:"DLE",17:"XON",18:"DC2",19:"XOFF",20:"DC4",21:"NAK",22:"SYN",23:"ETB",24:"CAN",25:"EM",26:"SUB",27:"ESC",28:"FS",29:"GS",30:"RS",31:"US",127:"DEL"};
function Ia(a,b,c){var d=0,e=a.length,f=0;for(void 0===c&&(c=function(a,b){return a>b?1:a<b?-1:0});d<e;){var g=d+e>>1;var h=c(b,a[g]);0<h?d=g+1:(e=g,f=!h)}return f?d:~d}
function Ja(){var a,b="";a||(a=new Date);for(var c=a.getHours(),d=a.getDate(),e=a.getMonth()+1,f=0;11>f;f++){var g;switch(g="Y-m-d H:i:s".charAt(f)){case "a":b+=12>c?"am":"pm";break;case "d":b+=("0"+d).slice(-2);break;case "D":b+=Ka[a.getDay()].substr(0,3);break;case "F":b+=La[e-1];break;case "g":b+=c?12<c?c-12:c:12;break;case "h":b+=c;break;case "H":b+=("0"+c).slice(-2);break;case "i":b+=("0"+a.getMinutes()).slice(-2);break;case "j":b+=d;break;case "l":b+=Ka[a.getDay()];break;case "m":b+=("0"+e).slice(-2);
break;case "M":b+=La[e-1].substr(0,3);break;case "n":b+=e;break;case "s":b+=("0"+a.getSeconds()).slice(-2);break;case "y":b+=(""+a.getFullYear()).slice(-2);break;case "Y":b+=a.getFullYear();break;default:b+=g}}return b}function Ma(a,b){if(Array.prototype.indexOf)return a.indexOf(b,c);var c=c||0;0>c&&(c+=a.length);0>c&&(c=0);for(var d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1}var Ka="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),La="January February March April May June July August September October November December".split(" ");
function Qa(a,b,c,d){c=void 0===c?!1:c;var e=0,f=null,g=null;if("object"==typeof resources&&(f=resources[a]))return d&&d(a,f,e),[f,e];if(c&&"function"==typeof resources)return resources(a,function(b,c){d&&d(a,b,c)}),g;var h=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");c&&(h.onreadystatechange=function(){4===h.readyState&&(f=h.responseText,200==h.status||!h.status&&f.length&&"file:"==(window?window.location.protocol:"file:")||(e=h.status||-1),d&&d(a,
f,e))});if(b&&"object"==typeof b){var k="",p;for(p in b)b.hasOwnProperty(p)&&(k&&(k+="\x26"),k+=p+"\x3d"+encodeURIComponent(b[p]));k=k.replace(/%20/g,"+");h.open("POST",a,c);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send(k)}else h.open("GET",a,c),"bytes"==b&&h.overrideMimeType("text/plain; charset\x3dx-user-defined"),h.send();c||(f=h.responseText,200!=h.status&&(e=h.status||-1),d&&d(a,f,e),g=[f,e]);return g}
function Ra(a,b){var c,d={ka:null,pa:null,Na:null,Fa:null};if("["==b.charAt(0)||"{"==b.charAt(0))try{var e,f;if("\x3c"==b.charAt(0))throw Error(b);var g=0>b.indexOf("0x")&&0>b.indexOf("0o")&&'["'!=b.substr(0,2)?JSON.parse(b.replace(/([a-z]+):/gm,'"$1":').replace(/\/\/[^\n]*/gm,"")):eval("("+b+")");d.Na=g.load;d.Fa=g.exec;if(e=g.bytes)d.ka=e;else if(e=g.words)for(d.ka=Array(2*e.length),f=c=0;c<e.length;c++)d.ka[f++]=e[c]&255,d.ka[f++]=e[c]>>8&255;else if(e=g.longs)for(d.ka=Array(4*e.length),f=c=0;c<
e.length;c++)d.ka[f++]=e[c]&255,d.ka[f++]=e[c]>>8&255,d.ka[f++]=e[c]>>16&255,d.ka[f++]=e[c]>>24&255;else(e=g.data)?d.Mf=e:d.ka=g;d.ka&&(d.ka.length?1==d.ka.length&&(r(d.ka[0]),d=null):(r("Empty resource: "+a),d=null));d.pa=g.symbols}catch(h){r("Resource data error ("+a+"): "+h.message),d=null}else{e=[];b=b.replace(/\n/gm," ").replace(/ +$/,"").split(" ");for(c=0;c<b.length;c++){f=parseInt(b[c],16);if(isNaN(f)){r("Resource data error ("+a+"): invalid hex byte ("+b[c]+")");break}e.push(f&255)}c==b.length&&
(d.ka=e)}return d}function Ca(){return"http://"+(window?window.location.host:"www.pcjs.org")}function Sa(){return window?window.navigator.userAgent:""}function Ta(){if(null==Ua){var a=!1;if(window)try{window.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a="PCjs.localStorage"==window.localStorage.getItem("PCjs.localStorage"),window.localStorage.removeItem("PCjs.localStorage")}catch(b){a=!1}Ua=a}return Ua}
function Va(a){if(window)try{var b=window.localStorage.getItem(a)}catch(c){}return b}function Wa(a,b){try{return window.localStorage.setItem(a,b),!0}catch(c){}return!1}function Xa(a){if(window){var b=Sa();return"iOS"==a&&!!b.match(/(iPod|iPhone|iPad)/)&&!!b.match(/AppleWebKit/)||"MSIE"==a&&!!b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)}return!1}
function Ya(a,b,c){if(a)for(var d=0;d<Za.length;d++){var e=Za[d];if(c){if(e+=c,b+e in a)return e}else if(e=e?e+b[0].toUpperCase():b[0],e+=b.substr(1),e in a)return e}return null}function $a(a){if(!ab){var b,c={};if(window){b||(b=window.location.search.substr(1));for(var d,e=/\+/g,f=/([^&=]+)=?([^&]*)/g;d=f.exec(b);)c[decodeURIComponent(d[1].replace(e," "))]=decodeURIComponent(d[2].replace(e," "))}ab=c}return ab[a]||ab[a.toLowerCase()]}
function bb(a,b,c){function d(){--a;0<=a&&(b()||(a=0));0<a?setTimeout(d,0):c()}d()}function cb(a,b){function c(){b(100===d)&&(e=setTimeout(c,d),d=100)}var d=0,e=null,f=!1;a.onmousedown=function(){f||e||(d=500,c())};a.ontouchstart=function(){e||(d=500,c())};a.onmouseup=a.onmouseout=function(){e&&(clearTimeout(e),e=null)};a.ontouchend=a.ontouchcancel=function(){e&&(clearTimeout(e),e=null);f=!0}}function gb(a,b){if(window){var c=window[a];window[a]="function"!==typeof c?b:function(){c&&c();b()}}}
function hb(a){ib.init.push(a)}function jb(a){if(kb)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){lb("An unexpected error occurred: "+c.message+"\n\nIf it happens again, please send this information to support@pcjs.org. Thanks.",void 0,void 0)}}function mb(a){!kb&&a?(kb=!0,nb&&pb("init"),qb&&pb("show")):kb=a}function pb(a){ib[a]&&jb(ib[a])}var ab=null,ib={init:[],show:[],exit:[]},Za=["","moz","ms","webkit"],nb=!1,qb=!1,kb=!0,Ua=null;gb("onload",function(){nb=!0;jb(ib.init)});
gb("onpageshow",function(){qb=!0;jb(ib.show)});gb(Xa("iOS")?"onpagehide":Xa("Opera")?"onunload":"onbeforeunload",function(){jb(ib.exit)});
function t(a,b,c){this.type=a;b||(b={id:"",name:""});this.id=b.id||"";this.name=b.name;this.uc=b.comment;this.yd=b;this.exports={};this.O=this.bindings={};a=this.id.indexOf(".");0>a?this.Fb=this.id:(this.Za=this.id.substr(0,a),this.Fb=this.id.substr(a+1));this.flags={ready:!1,hb:!1,Gb:!1,Nf:!1,ha:!1,Pb:!1,error:!1};this.wb=null;this.flags.error=!1;this.fa=c||0;this.I=this.w=this.H=this.P=null;sb.push(this)}function tb(a,b,c){ub[a]&&b&&(ub[a][b]=c)}function vb(){return Date.now()||+new Date}
function lb(a,b,c){b||r((c?c+": ":"")+a)}function r(a){window&&window.alert(a)}function wb(a){var b=!1;window&&(b=window.confirm(a));return b}function xb(a,b){a.value+=b;b=a.value;8192<b.length&&(a.value=b.substr(b.length-4096));a.scrollTop=a.scrollHeight}
function yb(a,b){b=zb(b.parentNode,"pc8080-control");for(var c=0;c<b.length;c++)for(var d=b[c].childNodes,e=0;e<d.length;e++){var f=d[e];if(1===f.nodeType){var g=f.getAttribute("class");if(g)for(var h=g.split(" "),k=0;k<h.length;k++)switch(g=h[k],g){case "pc8080-binding":(g=Ab(f))&&g.binding&&a.ca(g.type,g.binding,f,g.value),k=h.length}}}}function Cb(a){var b,c=[];a&&(a=0<(b=a.indexOf("."))?a.substr(0,b+1):"");for(b=0;b<sb.length;b++){var d=sb[b];a&&d.id.indexOf(a)||c.push(d)}return c}
function Db(a){if(void 0!==a){var b;for(b=0;b<sb.length;b++)if(sb[b].id===a)return sb[b]}return null}function Eb(a,b){var c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");for(d=0;d<sb.length;d++)if(c)c==sb[d]&&(c=null);else if(!(a!=sb[d].type||b&&sb[d].id.indexOf(b)))return sb[d]}return null}function Ab(a){var b=null;if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(c){r(c.message+" ("+a+")")}return b}
function zb(a,b,c){c&&(b+="-"+c+"-object");if(a.getElementsByClassName)return a.getElementsByClassName(b);var d;c=[];a=a.getElementsByTagName("*");var e=new RegExp("(^| )"+b+"( |$)");b=0;for(d=a.length;b<d;b++)e.test(a[b].className)&&c.push(a[b]);return c}
function Fb(a){for(var b=!0,c=Gb[a];c&&c.length;){var d=c.splice(0,1)[0],e=d[0],f=null;0<=Hb.indexOf(e)&&(f=function(){return function(){Fb(a)}}());var g=Ib[e];if(g)if(!f)b=g(d[1],d[2],d[3]);else{if(!g(f,d[1],d[2],d[3]))break}else{b=!1;var h=Eb(d[1],a);if(h)if(g=Jb[e])b=g(h,d[2],d[3]);else{var k=h.exports;if(k&&(g=k[e]))if(b=!0,!f)b=g.call(h,d[2],d[3]);else if(!g.call(h,f,d[2],d[3]))break}}if(!b){r("Script error: '"+e+(g?" failed":" unrecognized"));break}}c&&!c.length&&delete Gb[a];return b}l=t.prototype;
l.toString=function(){return this.name?this.name:this.id||this.type};
l.ca=function(a,b,c){switch(b){case "clear":return this.O[b]||(this.O[b]=c,c.onclick=function(a){return function(){a.O.print&&(a.O.print.value="")}}(this)),!0;case "print":return this.O[b]||(this.O[b]=c,this.Z=function(a){this.i(a,this.type);return!0},c.value="",this.print=function(a){return function(b){xb(a,b)}}(c),this.i=function(a,b){return function(a,c){a||(a="");if(c!=Kb||"..."!=a.slice(-3))c&&(a=c+": "+a),xb(b,a+"\n");else{c=b.value;var d=c.lastIndexOf(a);0>d?c+=a+"\n":c=c.substr(0,d)+(a+".")+
c.substr(d+a.length);8192<c.length&&(c=c.substr(c.length-4096));b.value=c;b.scrollTop=b.scrollHeight}}}(this,c)),!0;default:return!1}};l.log=function(){};l.print=function(){};l.i=function(){};l.status=function(a){this.i(this.type+": "+a)};l.Z=function(a,b,c){if(!b){var d=Eb("Computer",this.id);if(d&&d.flags.Pb)return console.log("ignoring notice during unload: "+a),!1}lb(a,b,c||this.type);return!0};function Lb(a,b){a.flags.error=!0;a.Z(b)}
function Mb(a,b){b&&(a.flags.ready?b():a.wb=b);return a.flags.ready}function Nb(a){if(!a.flags.error&&(a.flags.ready=!0,a.flags.ready)){var b=a.wb;a.wb=null;b&&b()}}function Ob(a,b){a.flags.hb&&(b?a.flags.Gb=!0:void 0===b&&a.i(a.toString()+" busy"));return a.flags.hb}function Pb(a,b){if(a.flags.Gb)return a.flags.hb=!1,a.flags.Gb=!1;if(a.flags.error)return a.i(a.toString()+" error"),!1;a.flags.hb=b;return a.flags.hb}l.ta=function(){return this.flags.ha=!0};
l.sa=function(a,b){b&&(this.flags.ha=!1);return!0};function Qb(a,b){b=void 0===b?0:b;if(a.I){a!==a.I&&(b=b||a.fa);var c=a.I.fa&b;return!!b&&c===b||!!(c&a.I.ud)}return!1}function Rb(a,b){a.I&&Qb(a,0)&&a.I.message(b,void 0)}function y(a,b,c,d,e,f,g){a.I&&(!0===g?g=0:null==g&&(g=a.fa),Sb(a.I,a,b,c,d,e,f,g))}var Kb="progress";
window&&(window.PCjs||(window.PCjs={}),window.PCjs.Machines||(window.PCjs.Machines={}),window.PCjs.Components||(window.PCjs.Components=[]),window.PCjs.Commands||(window.PCjs.Commands={}));
var ub=window?window.PCjs.Machines:{},sb=window?window.PCjs.Components:[],Gb=window?window.PCjs.Commands:{},Hb=["hold","sleep","wait"],Ib={alert:function(a){r(a);return!0},sleep:function(a,b){setTimeout(a,+b);return!1}},Jb={select:function(a,b,c){var d=!1;if(a=a.bindings[b])for(b=0;b<a.options.length;b++)if(a.options[b].textContent==c){a.selectedIndex!=b&&(a.selectedIndex=b);d=!0;break}return d}};
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;b++)if(this[b]===a)return b;return-1});Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return e.apply(this instanceof c&&a?this:a,d.concat(Array.prototype.slice.call(arguments)))}function c(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind: non-callable object");var d=Array.prototype.slice.call(arguments,1),e=this;c.prototype=this.prototype;b.prototype=new c;return b});
var Tb="undefined"!==typeof ArrayBuffer,Ub=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,
0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1],Xb={cpu:1,bus:64,mem:128,port:256,nvr:16384,chipset:32768,keyboard:65536,key:131072,video:262144,fdc:524288,disk:2097152,serial:8388608,speaker:33554432,computer:67108864,log:536870912,warn:1073741824,halt:-2147483648};function Yb(a){t.call(this,"Panel",a)}ia(Yb,t);
Yb.prototype.ca=function(a,b,c,d){return this.P&&this.P.ca(a,b,c,d)||this.w&&this.w.ca(a,b,c,d)||this.B&&this.B.ca(a,b,c,d)||this.I&&this.I.ca(a,b,c,d)?!0:t.prototype.ca.call(this,a,b,c,d)};Yb.prototype.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.I=d;this.B=Zb(a,"Keyboard")};Yb.prototype.ta=function(a,b){b||$b();return!0};Yb.prototype.sa=function(){return!0};
function $b(){for(var a=!1,b=zb(document,"pc8080","panel"),c=0;c<b.length;c++){var d=b[c],e=Ab(d),f=Db(e.id);f||(a=!0,f=new Yb(e));yb(f,d);a&&Nb(f)}}hb($b);
function ac(a,b,c){t.call(this,"Bus",a);this.w=b;this.I=c;this.L=a.busWidth||16;this.M=Math.pow(2,this.L);this.C=this.M-1|0;this.g=(this.L>>1)+2;10>this.g&&(this.g=10);15<this.g&&(this.g=15);this.u=1<<this.g;this.N=this.u>>2;this.j=this.u-1;this.J=this.M/this.u|0;this.G=this.J-1;this.A=[];this.B=[];this.D=this.F=!1;this.R=[];this.S=[];a=new A;bc(a,this.I);this.b=Array(this.J);for(b=0;b<this.J;b++)this.b[b]=a;Nb(this)}ia(ac,t);ac.prototype.reset=function(){};
ac.prototype.ta=function(a,b){b||this.reset();return!0};function cc(a,b,c,d){for(var e=b,f=c,g=e>>>a.g;0<f&&g<a.b.length;){var h=a.b[g],k=g*a.u,p=a.u-(e-k);p>f&&(p=f);if(h&&h.size){if(h.type==d){if(e+f<=h.K)return h.lb+=h.K-e,h.K=e,!0;if(e>=h.K+h.lb){p=h.size-(e-k);p>f&&(p=f);h.lb=e-h.K+p;e=k+a.u;f-=p;g++;continue}}return dc(ec,e,f)}e=new A(e,p,a.u,d);bc(e,a.I,h);a.b[g++]=e;e=k+a.u;f-=p}return 0>=f?(a.status(Math.floor(c/1024)+"Kb "+fc[d]+" at "+q(b)),!0):dc(gc,b,c)}
function hc(a,b){return a.b[(b&a.C)>>>a.g].kb(b&a.j,b)}function ic(a,b){var c=b&a.j,d=(b&a.C)>>>a.g;return c!=a.j?a.b[d].Fc(c,b):a.b[d++].Ua(c,b)|a.b[d&a.G].Ua(0,b+1)<<8}function jc(a,b){var c=b&a.j,d=(b&a.C)>>>a.g;return c!=a.j?a.b[d].Lb(c,b):a.b[d++].kb(c,b)|a.b[d&a.G].kb(0,b+1)<<8}function kc(a,b,c){a.b[(b&a.C)>>>a.g].mb(b&a.j,c&255,b)}function lc(a,b,c){var d=b&a.j,e=(b&a.C)>>>a.g;d!=a.j?a.b[e].Ic(d,c&65535,b):(a.b[e++].Wa(d,c&255,b),a.b[e&a.G].Wa(0,c>>8&255,b+1))}
function mc(a,b,c){a=a.b[b>>>a.g];c?0===--a.O&&(a.Wa=a.w?a.nb:a.mb,a.Ic=a.w?a.Qb:a.Rb):0===--a.H&&(a.Ua=a.kb,a.Fc=a.Lb)}function nc(a){for(var b=0,c=[],d=0;d<a.J;d++){var e=a.b[d];if(e.Ca||e.Bc){c[b++]=d;var f=b++;if(e=e.save()){for(var g=0,h=0,k=[];g<e.length;){for(var p=e[g],v=g+1;v<e.length&&e[v]===p;)v++;k[h++]=v-g;k[h++]=p;g=v}k.length<e.length&&(e=k)}c[f]=e}}return c}
function oc(a,b){if(void 0===b)return a.D=!a.D,a.D;void 0===a.A[b]&&(a.A[b]=[null,!1]);a.A[b][1]=!a.A[b][1];return a.A[b][1]}function pc(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,g=+e+d,h=c[e].bind(b);if(void 0!==h)for(var k=+e+d;k<=g;k++)void 0!==f.A[k]?r("Input port "+q(k)+" already registered"):f.A[k]=[h,!1]}}
function zc(a,b,c){for(var d=1,e=0,f=0;0<d;){var g=a.A[b],h=a.R[b]||1,k=1==h?255:2==h?65535:-1,p=k;void 0!==g?(g[0]&&(p=g[0](b,c),void 0===p?p=k:p&=k),a.I&&a.D!=g[1]&&Ac(a.I,b,p)):a.I&&(Sb(a.I,a,b,null,c),a.D&&Ac(a.I,b,p));e|=p<<f;f+=h<<3;b+=h;d-=h}return e}function Bc(a,b){if(void 0===b)return a.F=!a.F,a.F;void 0===a.B[b]&&(a.B[b]=[null,!1]);a.B[b][1]=!a.B[b][1];return a.B[b][1]}
function Cc(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,g=+e+d,h=c[e].bind(b);if(void 0!==h)for(var k=+e+d;k<=g;k++)void 0!==f.B[k]?r("Output port "+q(k)+" already registered"):f.B[k]=[h,!1]}}function Dc(a,b,c,d){for(var e=1,f=0;0<e;){var g=a.B[b],h=a.S[b]||1,k=1==h?255:2==h?65535:-1;k&=c>>>=f;if(void 0!==g){if(g[0])g[0](b,k,d);a.I&&a.F!=g[1]&&Ec(a.I,b,k)}else a.I&&(Sb(a.I,a,b,k,d),a.F&&Ec(a.I,b,k));f+=h<<3;b+=h;e-=h}}
function dc(a,b,c){r("Memory block error ("+a+": "+n(b)+","+n(c)+")");return!1}var ec=1,gc=2,Fc;if(Tb){var Gc=new ArrayBuffer(2);(new DataView(Gc)).setUint16(0,256,!0);Fc=256===(new Uint16Array(Gc))[0]}else Fc=!1;var Hc=Fc;
function A(a,b,c,d){this.id=Ic+=2;this.b=null;this.K=a;this.lb=b;this.size=c||0;this.type=d||Jc;this.w=d==Kc;bc(this);this.Ca=this.Bc=!1;if(c)if(Tb)this.P=new ArrayBuffer(c),this.j=new DataView(this.P,0,c),this.g=new Uint8Array(this.P,0,c),this.u=new Uint16Array(this.P,0,c>>1),this.b=new Int32Array(this.P,0,c>>2),Lc(this,Hc?Mc:Nc);else{this.b=Array(c>>2);for(a=0;a<this.b.length;a++)this.b[a]=0;Lc(this,Oc)}else Lc(this)}l=A.prototype;
l.save=function(){var a;if(Tb){var b=Array(this.size>>2);for(a=0;a<b.length;a++)b[a]=this.j.getInt32(a<<2,!0)}else b=this.b;return b};l.restore=function(a){if(a&&this.size==a.length<<2){var b;if(Tb)for(b=0;b<a.length;b++)this.j.setInt32(b<<2,a[b],!0);else this.b=a;return this.Ca=!0}return!1};function Lc(a,b){b||(b=Pc);Qc(a,b,void 0);Rc(a,b,void 0)}function Qc(a,b,c){c&&a.H||(a.Ua=b[0]||a.Ec,a.Fc=b[2]||a.Gc);if(c||void 0===c)a.kb=b[0]||a.Ec,a.Lb=b[2]||a.Gc}
function Rc(a,b,c){c&&a.O||(a.Wa=!a.w&&b[1]||a.nb,a.Ic=!a.w&&b[3]||a.Qb);if(c||void 0===c)a.mb=b[1]||a.nb,a.Rb=b[3]||a.Qb}l.Ma=function(a,b){b?0===this.O++&&Rc(this,Sc,!1):0===this.H++&&Qc(this,Sc,!1)};function bc(a,b,c){a.I=b;a.H=a.O=0;c&&((a.H=c.H)&&Qc(a,Sc,!1),(a.O=c.O)&&Rc(a,Sc,!1))}l.Ec=function(){this.I&&Qb(this.I,129)&&this.I.message("attempt to read invalid block %"+n(this.K),!0);return 255};
l.nb=function(a,b){this.I&&Qb(this.I,129)&&this.I.message("attempt to write "+q(b)+" to invalid block %"+n(this.K),!0)};l.Gc=function(a,b){return this.Ua(a++,b++)|this.Ua(a,b)<<8};l.Qb=function(a,b,c){this.Wa(a++,b&255,c++);this.Wa(a,b>>8,c)};l.ge=function(a){return this.b[a>>2]>>>((a&3)<<3)&255};l.ke=function(a){var b=a>>2;a=(a&3)<<3;var c=this.b[b]>>a;return 24>a?c&65535:c&255|(this.b[b+1]&255)<<8};l.ue=function(a,b){var c=a>>2;a=(a&3)<<3;this.b[c]=this.b[c]&~(255<<a)|b<<a;this.Ca=!0};
l.ye=function(a,b){var c=a>>2;a=(a&3)<<3;24>a?this.b[c]=this.b[c]&~(65535<<a)|b<<a:(this.b[c]=this.b[c]&16777215|b<<24,c++,this.b[c]=this.b[c]&-256|b>>8);this.Ca=!0};l.ee=function(a,b){if(this.I&&null!=this.K){var c=this.I;Tc(c,this.K+a,1,c.L)&&Uc(c,!0)}return this.kb(a,b)};l.ie=function(a,b){if(this.I&&null!=this.K){var c=this.I;Tc(c,this.K+a,2,c.L)&&Uc(c,!0)}return this.Lb(a,b)};
l.se=function(a,b,c){if(this.I&&null!=this.K){var d=this.I;Tc(d,this.K+a,1,d.B)&&Uc(d,!0)}this.w?this.nb(a,b,c):this.mb(a,b,c)};l.we=function(a,b,c){if(this.I&&null!=this.K){var d=this.I;Tc(d,this.K+a,2,d.B)&&Uc(d,!0)}this.w?this.nb(a,b,c):this.Rb(a,b,c)};l.de=function(a){return this.g[a]};l.fe=function(a){return this.g[a]};l.he=function(a){return this.j.getUint16(a,!0)};l.je=function(a){return a&1?this.g[a]|this.g[a+1]<<8:this.u[a>>1]};l.re=function(a,b){this.g[a]=b;this.Ca=!0};
l.te=function(a,b){this.g[a]=b;this.Ca=!0};l.ve=function(a,b){this.j.setUint16(a,b,!0);this.Ca=!0};l.xe=function(a,b){a&1?(this.g[a]=b,this.g[a+1]=b>>8):this.u[a>>1]=b;this.Ca=!0};var Jc=0,Kc=2,fc=["NONE","RAM","ROM","VID","H/W"],Ic=0,Pc=[],Oc=[A.prototype.ge,A.prototype.ue,A.prototype.ke,A.prototype.ye],Sc=[A.prototype.ee,A.prototype.se,A.prototype.ie,A.prototype.we];if(Tb)var Nc=[A.prototype.de,A.prototype.re,A.prototype.he,A.prototype.ve],Mc=[A.prototype.fe,A.prototype.te,A.prototype.je,A.prototype.xe];
function Vc(a,b){t.call(this,"CPU",a,1);var c=a.multiplier||1;this.xa=a.cycles||b;this.S=c;this.Qa=Math.round(this.xa/1E4)/100;this.Y=this.Qa*this.S;this.flags.ia=!1;this.flags.Ob=!1;this.flags.gb=a.autoStart;this.flags.zc=!1;this.flags.Ta=!1;this.ua=this.ma=0;this.wa=a.csStart;this.la=a.csInterval;this.qa=a.csStop;this.T=[];this.Ab=this.pb.bind(this);Nb(this)}ia(Vc,t);l=Vc.prototype;
l.Da=function(a,b,c,d){this.P=a;this.H=b;this.I=d;for(b=0;b<Wc.length;b++)(c=this.O[Wc[b]])&&this.P.ca(null,Wc[b],c);this.V=Zb(a,"ChipSet");a=Xc(a,"autoStart");null!=a&&(this.flags.gb="true"==a?!0:"false"==a?!1:!!a);Nb(this)};l.reset=function(){};l.save=function(){return null};l.restore=function(){return!1};
l.ta=function(a,b){if(!b){if(a&&this.restore){Yc(this);if(!this.restore(a))return!1;Zc(this)}else this.reset();this.I?(a=this.I,a.i("Type ? for help with PC8080 Debugger commands"),$c(a),a.la&&(b=a.la,a.la=null,ad(a,b))):this.i("No debugger detected")}bd(this);return!0};l.sa=function(a){return a?this.save():!0};l.gb=function(){return this.flags.gb||!this.I&&void 0===this.O.run?(this.pb(),!0):!1};l.Cc=function(){return 0};
function Zc(a){void 0===a.wa&&(a.wa=0);void 0===a.la&&(a.la=-1);void 0===a.qa&&(a.qa=-1);a.flags.Ta=0<=a.wa&&0<a.la;a.flags.Ta&&(a.ua=0,a.ma=a.wa-a.ja)}function cd(a,b){if(a.flags.Ta){var c=!1;a.ua=a.ua+a.Cc()|0;a.ma-=b;0>=a.ma&&(a.ma+=a.la,c=!0);0<=a.qa&&a.qa<=dd(a)&&(a.la=a.qa=-1,Zc(a),ed(a),c=!0);c&&a.i(dd(a)+" cycles: checksum\x3d"+n(a.ua))}}
l.ca=function(a,b,c){var d=this;a=!1;switch(b){case "power":case "reset":this.O[b]=c;a=!0;break;case "run":this.O[b]=c;c.onclick=function(){var a;if(a=d.P)if(a=d.P,a.flags.ha)a=!0;else{var b=null,c,h=Cb(a.id);for(c=0;c<h.length&&(b=h[c],b===a||b.flags.ready);c++);if(c==h.length)for(c=0;c<h.length&&(b=h[c],b===a||b.flags.ha);c++);c==h.length&&(b=a);r("The "+b.type+" component ("+b.id+") is not "+(b.flags.ready?"powered yet":"ready yet"+(b.wb?" (waiting for notification)":""))+".");a=!1}a&&(d.flags.ia?
ed(d):d.pb())};a=!0;break;case "speed":this.O[b]=c;a=!0;break;case "setSpeed":this.O[b]=c,c.onclick=function(){pd(d,d.S<<1,!0)},c.textContent=this.Y.toFixed(2)+"Mhz",a=!0}return a};function qd(a,b,c){a.ja+=b;c&&(a.da=a.b=0)}function rd(a,b){var c=1;b&&1<a.S&&a.X&&(c=a.X/a.Qa);a.eb=Math.round(1E3/sd);a.Ka=Math.floor(a.xa/sd*c);b||(a.ra=a.Ka);a.Sa=0}function dd(a){return a.ja+a.W+a.da-a.b}function Yc(a){a.X=0;a.fb=0;a.ja=a.W=a.da=a.b=0;Zc(a);pd(a,1)}
function pd(a,b,c){var d=!1;if(void 0!==b){.8>a.X/a.Y?b=1:d=!0;a.S=b;b=a.Qa*a.S;if(a.Y!=b){a.Y=b;b=a.Y.toFixed(2)+"Mhz";var e=a.O.setSpeed;e&&(e.textContent=b);a.i("target speed: "+b)}c&&a.P&&a.P.Va()}qd(a,a.W);a.W=0;a.U=vb();a.aa=0;rd(a);return d}function td(a,b,c){var d=void 0===d?-1:d;var e=a.T.length;a.T.push([b,-1,d,c]);0<=d&&ud(a,e,d);return e}function ud(a,b,c){0<=b&&b<a.T.length&&(b=a.T[b],0>b[1]&&(c=a.xa*a.S/1E3*c|0,a.flags.ia&&(c+=vd(a)),b[1]=c))}
function vd(a,b){var c=a.da-=a.b;a.b=0;b&&(a.da=0);return c}
l.pb=function(a){if(Pb(this,!0)){if(!this.flags.ia){pd(this);this.P&&this.P.start(this.U,dd(this));this.flags.ia=!0;this.flags.Ob=!0;this.V&&this.V.start();var b=this.O.run;b&&(b.textContent="Halt");this.P&&(wd(this.P,!0),a&&this.P.Va(!0))}this.Sa>=this.xa&&rd(this,!0);this.Ba=0;this.Ja=vb();this.aa&&(a=this.Ja-this.aa,a>this.eb&&(this.U+=a,this.U>this.Ja&&(this.U=this.Ja)));try{do{for(var c,d=this.flags.Ta?1:this.Ka,e=this.T.length-1;0<=e;e--){var f=this.T[e];0>f[1]||d>f[1]&&(d=f[1])}c=d;this.Bb(c);
c=vd(this,!0);this.Ba+=c;this.W+=c;cd(this,c);a=c;for(var g=this.T.length-1;0<=g;g--){var h=this.T[g];0>h[1]||(h[1]-=a,0>=h[1]&&(h[1]=-1,h[3](),0<=h[2]&&ud(this,g,h[2])))}this.ra-=c;if(0>=this.ra){this.ra+=this.Ka;++this.fb>=xd&&(this.P&&wd(this.P),this.fb=0);break}}while(this.flags.ia)}catch(k){ed(this);bd(this);this.P&&this.P.stop(vb(),dd(this));Pb(this,!1);Lb(this,k.stack||k.message);return}c=setTimeout;d=this.Ab;this.aa=vb();e=this.eb;this.Ba&&(e=Math.round(e*this.Ba/this.Ka));e-=this.aa-this.Ja;
if(f=this.aa-this.U)this.X=Math.round(this.W/(10*f))/100,864E5<=f&&(this.ja=0,pd(this));if(0>e||this.X<this.Y)-1E3>e&&(this.U-=e),e=0;this.Sa+=this.Ba;this.aa+=e;c(d,e)}else bd(this),this.P&&this.P.stop(vb(),dd(this))};l.Bb=function(){return 0};function ed(a,b){Ob(a,!0);vd(a);qd(a,a.W);a.W=0;if(a.flags.ia){a.flags.ia=!1;a.V&&a.V.stop();var c=a.O.run;c&&(c.textContent="Run")}a.flags.complete=b}function bd(a,b){if(a.P){for(var c=a.P,d=0;d<c.A.length;d++)yd(c.A[d],b);wd(a.P,b)}}
var sd=30,xd=15,Wc=["power","reset"];function zd(a){var b=+a.model||8080;Vc.call(this,a,1E6);this.tb=b;this.ab=Ad;Yc(this);this.flags.complete=this.flags.xd=!1;this.cb=0;this.Ia=[];this.bb=0;Bd(this)}ia(zd,Vc);function Cd(a,b){a.Ia.push(b)}l=zd.prototype;l.reset=function(){this.flags.ia&&ed(this);Bd(this);Yc(this);this.flags.error=!1;Vc.prototype.reset.call(this)};function Bd(a){a.g=0;a.u=0;a.A=0;a.B=0;a.C=0;a.D=0;a.F=0;a.L=0;B(a,a.bb);Dd(a,0);a.R=0}function Ed(a,b){a.bb=b;B(a,b)}
l.Cc=function(){var a=this.g+this.u+this.A+this.B+this.C+this.D+this.F|0;return a=a+this.L+this.j+Fd(this)|0};l.save=function(){var a=new Gd(this);a.set(0,[this.g,this.u,this.A,this.B,this.C,this.D,this.F,this.L,this.j,Fd(this)]);a.set(1,[this.R,this.ja,this.S]);a.set(2,nc(this.H));return a.data()};
l.restore=function(a){var b=a[0];this.g=b[0];this.u=b[1];this.A=b[2];this.B=b[3];this.C=b[4];this.D=b[5];this.F=b[6];this.L=b[7]&65535;B(this,b[8]);Dd(this,b[9]);b=a[1];this.R=b[0];this.ja=b[1];pd(this,b[3]);a:{b=this.H;a=a[2];var c;for(c=0;c<a.length-1;c+=2){var d=a[c],e=a[c+1];if(e&&e.length<b.N){for(var f=0,g=Array(b.N),h=0;h<e.length-1;)for(var k=e[h++],p=e[h++];k--;)g[f++]=p;e=g}f=b.b[d];if(!f||!f.restore(e)){r("Unable to restore memory block "+d);b=!1;break a}}b=!0}return b};
l.ca=function(a,b,c){switch(b){case "A":case "B":case "C":case "BC":case "D":case "E":case "DE":case "H":case "L":case "HL":case "SP":case "PC":case "PS":case "IF":case "SF":case "ZF":case "AF":case "PF":case "CF":this.O[b]=c;this.cb++;a=!0;break;default:a=Vc.prototype.ca.call(this,a,b,c)}return a};function Hd(a){return a.u<<8|a.A}function Id(a,b){a.u=b>>8&255;a.A=b&255}function Jd(a){return a.B<<8|a.C}function Kd(a,b){a.B=b>>8&255;a.C=b&255}function C(a){return a.D<<8|a.F}
function Ld(a,b){a.D=b>>8&255;a.F=b&255}function B(a,b){a.j=b&65535}function Md(a){return a.G&256?1:0}function Nd(a,b){a.G=a.G&255|b}function Od(a){return Ub[a.J&255]?4:0}function Pd(a){return(a.J^a.N)&16?16:0}function Qd(a){return a.G&255?0:64}function Rd(a){return a.J&128?128:0}function Fd(a){return a.M&-214|Rd(a)|Qd(a)|Pd(a)|Od(a)|Md(a)}function Dd(a,b){a.G=a.J=a.N=0;b&1&&(a.G|=256);b&4||(a.J|=1);b&16&&(a.N|=16);b&64||(a.G|=255);b&128&&(a.J^=192);a.M=a.M&-726|b&512|2}
function Sd(a,b){a.N=a.g^b;return a.J=(a.G=a.g+b)&255}function Td(a,b){a.N=a.g^b;return a.J=(a.G=a.g+b+(a.G&256?1:0))&255}function Ud(a,b){a.G=a.J=a.N=a.g&b;(a.g|b)&8&&(a.N^=16);return a.G}function Vd(a,b){a.N=b^255;b=a.J=b+255&255;a.G=a.G&-256|b;return b}function Wd(a,b){a.N=b;b=a.J=b+1&255;a.G=a.G&-256|b;return b}function Xd(a,b){return a.J=a.G=a.N=a.g|b}function Yd(a,b){b^=255;a.N=a.g^b;return a.J=(a.G=a.g+b+1^256)&255}
function Zd(a,b){b^=255;a.N=a.g^b;return a.J=(a.G=a.g+b+(a.G&256?0:1)^256)&255}function $d(a,b){return a.J=a.G=a.N=a.g^b}function E(a,b){a=a.H;return a.b[(b&a.C)>>>a.g].Ua(b&a.j,b)}function ae(a,b,c){a=a.H;a.b[(b&a.C)>>>a.g].Wa(b&a.j,c&255,b)}function F(a){var b=E(a,a.j);B(a,a.j+1);return b}function G(a){var b=ic(a.H,a.j);B(a,a.j+2);return b}function be(a){var b=ic(a.H,a.L);a.L=a.L+2&65535;return b}function H(a,b){a.L=a.L-2&65535;lc(a.H,a.L,b)}
function ce(a){if(a.b&&a.R&255&&a.M&512){for(var b=0;8>b&&!(a.R&1<<b);b++);a.R&=~(0>b?255:1<<b);a.M&=-513;a.R&=-257;a.ab[199|b<<3].call(a)}return a.R&256?(vd(a),!1):!0}function de(a,b){a.R|=1<<b;a.M&512&&vd(a)}function I(a,b,c,d){d=d||2;a.O[b]&&(void 0===c&&(Lb(a,"Value for "+b+" is invalid"),ed(a)),c=!a.flags.ia||a.flags.zc?n(c,d):"--------".substr(0,d),a.O[b].textContent!=c&&(a.O[b].textContent=c))}
l.Bb=function(a){this.flags.complete=!0;var b=this.flags.xd=this.I&&ee(this.I),c=a?this.flags.Ob?0:1:-1;this.flags.Ob=!1;this.da=this.b=a;if(ce(this)){do{if(b){if(fe(this.I,this.j,c)){ed(this);break}c=1}this.ab[F(this)].call(this)}while(0<this.b)}return this.flags.complete?this.da-this.b:void 0===this.flags.complete?0:-1};hb(function(){for(var a=zb(document,"pc8080","cpu"),b=0;b<a.length;b++){var c=a[b],d=Ab(c);d=new zd(d);yb(d,c)}});function ge(){this.b-=4}
function he(){B(this,G(this));this.b-=10}function ie(){B(this,be(this));this.b-=10}function je(){var a=G(this);H(this,this.j);B(this,a);this.b-=17}
var Ad=[ge,function(){Id(this,G(this));this.b-=10},function(){ae(this,Hd(this),this.g);this.b-=7},function(){Id(this,Hd(this)+1);this.b-=5},function(){this.u=Wd(this,this.u);this.b-=5},function(){this.u=Vd(this,this.u);this.b-=5},function(){this.u=F(this);this.b-=7},function(){var a=this.g<<1;this.g=a&255|a>>8;Nd(this,a&256);this.b-=4},ge,function(){var a;Ld(this,a=C(this)+Hd(this));Nd(this,a>>8&256);this.b-=10},function(){this.g=E(this,Hd(this));this.b-=7},function(){Id(this,Hd(this)-1);this.b-=
5},function(){this.A=Wd(this,this.A);this.b-=5},function(){this.A=Vd(this,this.A);this.b-=5},function(){this.A=F(this);this.b-=7},function(){var a=this.g<<8&256;this.g=(a|this.g)>>1;Nd(this,a);this.b-=4},ge,function(){Kd(this,G(this));this.b-=10},function(){ae(this,Jd(this),this.g);this.b-=7},function(){Kd(this,Jd(this)+1);this.b-=5},function(){this.B=Wd(this,this.B);this.b-=5},function(){this.B=Vd(this,this.B);this.b-=5},function(){this.B=F(this);this.b-=7},function(){var a=this.g<<1;this.g=a&255|
Md(this);Nd(this,a&256);this.b-=4},ge,function(){var a;Ld(this,a=C(this)+Jd(this));Nd(this,a>>8&256);this.b-=10},function(){this.g=E(this,Jd(this));this.b-=7},function(){Kd(this,Jd(this)-1);this.b-=5},function(){this.C=Wd(this,this.C);this.b-=5},function(){this.C=Vd(this,this.C);this.b-=5},function(){this.C=F(this);this.b-=7},function(){var a=this.g<<8;this.g=(Md(this)<<8|this.g)>>1;Nd(this,a&256);this.b-=4},ge,function(){Ld(this,G(this));this.b-=10},function(){var a=G(this);lc(this.H,a,C(this));
this.b-=16},function(){Ld(this,C(this)+1);this.b-=5},function(){this.D=Wd(this,this.D);this.b-=5},function(){this.D=Vd(this,this.D);this.b-=5},function(){this.D=F(this);this.b-=7},function(){var a=0,b=Md(this);if(Pd(this)||9<(this.g&15))a|=6;if(b||154<=this.g)a|=96,b=1;this.g=Sd(this,a);Nd(this,b?256:0);this.b-=4},ge,function(){var a;Ld(this,a=C(this)+C(this));Nd(this,a>>8&256);this.b-=10},function(){var a=G(this);a=ic(this.H,a);Ld(this,a);this.b-=16},function(){Ld(this,C(this)-1);this.b-=5},function(){this.F=
Wd(this,this.F);this.b-=5},function(){this.F=Vd(this,this.F);this.b-=5},function(){this.F=F(this);this.b-=7},function(){this.g=~this.g&255;this.b-=4},ge,function(){this.L=G(this)&65535;this.b-=10},function(){ae(this,G(this),this.g);this.b-=13},function(){this.L=this.L+1&65535;this.b-=5},function(){var a=C(this);ae(this,a,Wd(this,E(this,a)));this.b-=10},function(){var a=C(this);ae(this,a,Vd(this,E(this,a)));this.b-=10},function(){ae(this,C(this),F(this));this.b-=10},function(){this.G|=256;this.b-=
4},ge,function(){var a;Ld(this,a=C(this)+this.L);Nd(this,a>>8&256);this.b-=10},function(){this.g=E(this,G(this));this.b-=13},function(){this.L=this.L-1&65535;this.b-=5},function(){this.g=Wd(this,this.g);this.b-=5},function(){this.g=Vd(this,this.g);this.b-=5},function(){this.g=F(this);this.b-=7},function(){Nd(this,Md(this)?0:256);this.b-=4},function(){this.b-=5},function(){this.u=this.A;this.b-=5},function(){this.u=this.B;this.b-=5},function(){this.u=this.C;this.b-=5},function(){this.u=this.D;this.b-=
5},function(){this.u=this.F;this.b-=5},function(){this.u=E(this,C(this));this.b-=7},function(){this.u=this.g;this.b-=5},function(){this.A=this.u;this.b-=5},function(){this.b-=5},function(){this.A=this.B;this.b-=5},function(){this.A=this.C;this.b-=5},function(){this.A=this.D;this.b-=5},function(){this.A=this.F;this.b-=5},function(){this.A=E(this,C(this));this.b-=7},function(){this.A=this.g;this.b-=5},function(){this.B=this.u;this.b-=5},function(){this.B=this.A;this.b-=5},function(){this.b-=5},function(){this.B=
this.C;this.b-=5},function(){this.B=this.D;this.b-=5},function(){this.B=this.F;this.b-=5},function(){this.B=E(this,C(this));this.b-=7},function(){this.B=this.g;this.b-=5},function(){this.C=this.u;this.b-=5},function(){this.C=this.A;this.b-=5},function(){this.C=this.B;this.b-=5},function(){this.b-=5},function(){this.C=this.D;this.b-=5},function(){this.C=this.F;this.b-=5},function(){this.C=E(this,C(this));this.b-=7},function(){this.C=this.g;this.b-=5},function(){this.D=this.u;this.b-=5},function(){this.D=
this.A;this.b-=5},function(){this.D=this.B;this.b-=5},function(){this.D=this.C;this.b-=5},function(){this.b-=5},function(){this.D=this.F;this.b-=5},function(){this.D=E(this,C(this));this.b-=7},function(){this.D=this.g;this.b-=5},function(){this.F=this.u;this.b-=5},function(){this.F=this.A;this.b-=5},function(){this.F=this.B;this.b-=5},function(){this.F=this.C;this.b-=5},function(){this.F=this.D;this.b-=5},function(){this.b-=5},function(){this.F=E(this,C(this));this.b-=7},function(){this.F=this.g;
this.b-=5},function(){ae(this,C(this),this.u);this.b-=7},function(){ae(this,C(this),this.A);this.b-=7},function(){ae(this,C(this),this.B);this.b-=7},function(){ae(this,C(this),this.C);this.b-=7},function(){ae(this,C(this),this.D);this.b-=7},function(){ae(this,C(this),this.F);this.b-=7},function(){var a=this.j-1;if(this.Ia.length)for(var b=0;b<this.Ia.length;b++)if(this.Ia[b](a))return;this.b-=7;this.R|=256;vd(this);this.I&&Qb(this,-2147483648)?(B(this,a),Uc(this.I)):this.M&512||(this.I&&B(this,a),
ed(this))},function(){ae(this,C(this),this.g);this.b-=7},function(){this.g=this.u;this.b-=5},function(){this.g=this.A;this.b-=5},function(){this.g=this.B;this.b-=5},function(){this.g=this.C;this.b-=5},function(){this.g=this.D;this.b-=5},function(){this.g=this.F;this.b-=5},function(){this.g=E(this,C(this));this.b-=7},function(){this.b-=5},function(){this.g=Sd(this,this.u);this.b-=4},function(){this.g=Sd(this,this.A);this.b-=4},function(){this.g=Sd(this,this.B);this.b-=4},function(){this.g=Sd(this,
this.C);this.b-=4},function(){this.g=Sd(this,this.D);this.b-=4},function(){this.g=Sd(this,this.F);this.b-=4},function(){this.g=Sd(this,E(this,C(this)));this.b-=7},function(){this.g=Sd(this,this.g);this.b-=4},function(){this.g=Td(this,this.u);this.b-=4},function(){this.g=Td(this,this.A);this.b-=4},function(){this.g=Td(this,this.B);this.b-=4},function(){this.g=Td(this,this.C);this.b-=4},function(){this.g=Td(this,this.D);this.b-=4},function(){this.g=Td(this,this.F);this.b-=4},function(){this.g=Td(this,
E(this,C(this)));this.b-=7},function(){this.g=Td(this,this.g);this.b-=4},function(){this.g=Yd(this,this.u);this.b-=4},function(){this.g=Yd(this,this.A);this.b-=4},function(){this.g=Yd(this,this.B);this.b-=4},function(){this.g=Yd(this,this.C);this.b-=4},function(){this.g=Yd(this,this.D);this.b-=4},function(){this.g=Yd(this,this.F);this.b-=4},function(){this.g=Yd(this,E(this,C(this)));this.b-=7},function(){this.g=Yd(this,this.g);this.b-=4},function(){this.g=Zd(this,this.u);this.b-=4},function(){this.g=
Zd(this,this.A);this.b-=4},function(){this.g=Zd(this,this.B);this.b-=4},function(){this.g=Zd(this,this.C);this.b-=4},function(){this.g=Zd(this,this.D);this.b-=4},function(){this.g=Zd(this,this.F);this.b-=4},function(){this.g=Zd(this,E(this,C(this)));this.b-=7},function(){this.g=Zd(this,this.g);this.b-=4},function(){this.g=Ud(this,this.u);this.b-=4},function(){this.g=Ud(this,this.A);this.b-=4},function(){this.g=Ud(this,this.B);this.b-=4},function(){this.g=Ud(this,this.C);this.b-=4},function(){this.g=
Ud(this,this.D);this.b-=4},function(){this.g=Ud(this,this.F);this.b-=4},function(){this.g=Ud(this,E(this,C(this)));this.b-=7},function(){this.g=Ud(this,this.g);this.b-=4},function(){this.g=$d(this,this.u);this.b-=4},function(){this.g=$d(this,this.A);this.b-=4},function(){this.g=$d(this,this.B);this.b-=4},function(){this.g=$d(this,this.C);this.b-=4},function(){this.g=$d(this,this.D);this.b-=4},function(){this.g=$d(this,this.F);this.b-=4},function(){this.g=$d(this,E(this,C(this)));this.b-=7},function(){this.g=
$d(this,this.g);this.b-=4},function(){this.g=Xd(this,this.u);this.b-=4},function(){this.g=Xd(this,this.A);this.b-=4},function(){this.g=Xd(this,this.B);this.b-=4},function(){this.g=Xd(this,this.C);this.b-=4},function(){this.g=Xd(this,this.D);this.b-=4},function(){this.g=Xd(this,this.F);this.b-=4},function(){this.g=Xd(this,E(this,C(this)));this.b-=7},function(){this.g=Xd(this,this.g);this.b-=4},function(){Yd(this,this.u);this.b-=4},function(){Yd(this,this.A);this.b-=4},function(){Yd(this,this.B);this.b-=
4},function(){Yd(this,this.C);this.b-=4},function(){Yd(this,this.D);this.b-=4},function(){Yd(this,this.F);this.b-=4},function(){Yd(this,E(this,C(this)));this.b-=7},function(){Yd(this,this.g);this.b-=4},function(){Qd(this)||(B(this,be(this)),this.b-=6);this.b-=5},function(){Id(this,be(this));this.b-=10},function(){var a=G(this);Qd(this)||B(this,a);this.b-=10},he,function(){var a=G(this);Qd(this)||(H(this,this.j),B(this,a),this.b-=6);this.b-=11},function(){H(this,Hd(this));this.b-=11},function(){this.g=
Sd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,0);this.b-=11},function(){Qd(this)&&(B(this,be(this)),this.b-=6);this.b-=5},ie,function(){var a=G(this);Qd(this)&&B(this,a);this.b-=10},he,function(){var a=G(this);Qd(this)&&(H(this,this.j),B(this,a),this.b-=6);this.b-=11},je,function(){this.g=Td(this,F(this));this.b-=7},function(){H(this,this.j);B(this,8);this.b-=11},function(){Md(this)||(B(this,be(this)),this.b-=6);this.b-=5},function(){Kd(this,be(this));this.b-=10},function(){var a=G(this);
Md(this)||B(this,a);this.b-=10},function(){var a=F(this);Dc(this.H,a,this.g,this.j+-2&65535);this.b-=10},function(){var a=G(this);Md(this)||(H(this,this.j),B(this,a),this.b-=6);this.b-=11},function(){H(this,Jd(this));this.b-=11},function(){this.g=Yd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,16);this.b-=11},function(){Md(this)&&(B(this,be(this)),this.b-=6);this.b-=5},ie,function(){var a=G(this);Md(this)&&B(this,a);this.b-=10},function(){var a=F(this);this.g=zc(this.H,a,this.j+-2&65535)&
255;this.b-=10},function(){var a=G(this);Md(this)&&(H(this,this.j),B(this,a),this.b-=6);this.b-=11},je,function(){this.g=Zd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,24);this.b-=11},function(){Od(this)||(B(this,be(this)),this.b-=6);this.b-=5},function(){Ld(this,be(this));this.b-=10},function(){var a=G(this);Od(this)||B(this,a);this.b-=10},function(){var a=be(this);H(this,C(this));Ld(this,a);this.b-=18},function(){var a=G(this);Od(this)||(H(this,this.j),B(this,a),this.b-=6);this.b-=
11},function(){H(this,C(this));this.b-=11},function(){this.g=Ud(this,F(this));this.b-=7},function(){H(this,this.j);B(this,32);this.b-=11},function(){Od(this)&&(B(this,be(this)),this.b-=6);this.b-=5},function(){B(this,C(this));this.b-=5},function(){var a=G(this);Od(this)&&B(this,a);this.b-=10},function(){var a=C(this);Ld(this,Jd(this));Kd(this,a);this.b-=5},function(){var a=G(this);Od(this)&&(H(this,this.j),B(this,a),this.b-=6);this.b-=11},je,function(){this.g=$d(this,F(this));this.b-=7},function(){H(this,
this.j);B(this,40);this.b-=11},function(){Rd(this)||(B(this,be(this)),this.b-=6);this.b-=5},function(){var a=be(this);Dd(this,a&255|this.M&-256);this.g=a>>8;this.b-=10},function(){var a=G(this);Rd(this)||B(this,a);this.b-=10},function(){this.M&=-513;this.b-=4},function(){var a=G(this);Rd(this)||(H(this,this.j),B(this,a),this.b-=6);this.b-=11},function(){H(this,Fd(this)&255|this.g<<8);this.b-=11},function(){this.g=Xd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,48);this.b-=11},function(){Rd(this)&&
(B(this,be(this)),this.b-=6);this.b-=5},function(){this.L=C(this)&65535;this.b-=5},function(){var a=G(this);Rd(this)&&B(this,a);this.b-=10},function(){this.M|=512;this.b-=4;ce(this)},function(){var a=G(this);Rd(this)&&(H(this,this.j),B(this,a),this.b-=6);this.b-=11},je,function(){Yd(this,F(this));this.b-=7},function(){H(this,this.j);B(this,56);this.b-=11}];
function ke(a){t.call(this,"ChipSet",a,32768);var b=a.model;b&&!le[b]&&lb("Unrecognized ChipSet model: "+b);this.g=le[b]||{};a.sound&&(this.T=null,window&&(this.T=window.AudioContext||window.webkitAudioContext),this.T&&new this.T);Nb(this)}ia(ke,t);l=ke.prototype;l.ca=function(){return!1};
l.Da=function(a,b,c,d){this.H=b;this.w=c;this.I=d;this.P=a;this.B=Zb(a,"Keyboard");this.C=Zb(a,"SerialPort");this.video=Zb(a,"Video");pc(b,this,this.g.yb);Cc(b,this,this.g.zb);if(d){var e=this;me(d,16384,function(){for(var a="",b=0;b<e.j.length;b++)a&&(a+=b&&b%10?", ":",\n"),a+=q(e.j[b]);e.I.i(a)})}};l.ta=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};l.sa=function(a){return a?this.save():!0};l.reset=function(){this.g.INIT&&!this.restore(this.g.INIT)&&this.Z("reset error")};
l.save=function(){var a=new Gd(this);switch(this.g.na){case ne.na:a.set(0,[this.aa,this.A,this.da,this.M,this.S,this.X,this.Y]);break;case J.na:a.set(0,[this.V,this.D]),a.set(1,[this.F,this.G]),a.set(2,[this.u,this.N,this.W,this.U]),a.set(3,[this.L,this.b,this.J,this.R,this.j])}return a.data()};
l.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.g.na){case ne.na:return this.aa=b[0],this.A=b[1],this.da=b[2],this.M=b[3],this.S=b[4],this.X=b[5],this.Y=b[6],!0;case J.na:return this.V=b[0],this.D=b[1],b=a[1],this.F=b[0],this.G=b[1],b=a[2],this.u=b[0],this.N=b[1],this.W=b[2],this.U=b[3],b=a[3],this.L=b[0],this.b=b[1],this.J=b[2],this.R=b[3],this.j=b[4],!0}return!1};l.start=function(){};l.stop=function(){};l.Hd=function(a,b){var c=this.aa;y(this,a,null,b,"STATUS0",c,!0);return c};
l.Id=function(a,b){var c=this.A;y(this,a,null,b,"STATUS1",c,!0);return c};l.Jd=function(a,b){var c=this.da;y(this,a,null,b,"STATUS2",c,!0);return c};l.Gd=function(a,b){var c=this.M>>8-this.S&255;y(this,a,null,b,"SHIFT.RESULT",c,!0);return c};l.Ud=function(a,b,c){y(this,a,b,c,"SHIFT.COUNT",null,!0);this.S=b};l.Wd=function(a,b,c){y(this,a,b,c,"SOUND1",null,!0);this.X=b};l.Vd=function(a,b,c){y(this,a,b,c,"SHIFT.DATA",null,!0);this.M=b<<8|this.M>>8};
l.Xd=function(a,b,c){y(this,a,b,c,"SOUND2",null,!0);this.Y=b};l.Yd=function(a,b,c){y(this,a,b,c,"WATCHDOG",null,!0)};function oe(a){var b=0,c=0,d=~a.L;for(a=0;10>a;a++)d&1&&(b=9-a),d>>=1;for(a=0;10>a;a++)d&1&&(c=9-a),d>>=1;return 10*b+c}
l.Kd=function(a,b){var c=this.D;c&=~J.va.ic;if((dd(this.w)&64)<<1&&(c|=J.va.ic,c!=this.D)){var d=this.J&1;var e=this.J>>1&7;switch(e){case J.ya.Ga.ld:break;case J.ya.Ga.Jc:this.L=this.L<<1|d;break;case J.ya.Ga.Pc:d=oe(this);this.j[d]=J.ya.rb;Rb(this,"doNVRCommand(): erase data at addr "+q(d));break;case J.ya.Ga.Kc:this.b=this.b<<1|d;break;case J.ya.Ga.pd:d=oe(this);e=this.b&J.ya.rb;this.j[d]=e;Rb(this,"doNVRCommand(): write data "+q(e)+" to addr "+q(d));break;case J.ya.Ga.jd:d=oe(this);e=this.j[d];
null==e&&(e=J.ya.rb);this.b=e;Rb(this,"doNVRCommand():  read data "+q(e)+" from addr "+q(d));break;case J.ya.Ga.kd:this.b<<=1;this.R=this.b&J.ya.rb+1;break;default:Rb(this,"doNVRCommand(): unrecognized command "+xa(e))}}c&=~J.va.jc;this.R&&(c|=J.va.jc);c&=~J.va.cc;if(d=this.B){d=this.B;if(e=d.A)e=d.w,e=dd(d.w)>=d.F+(e.xa*e.S/1E3*1.2731488|0);e&&(d.A=!1);d=!d.A}d&&(c|=J.va.cc);c&=~J.va.rc;this.C&&this.C.ga&pe&&(c|=J.va.rc);this.D=c;y(this,a,null,b,"FLAGS",c);return c};
l.Zd=function(a,b,c){y(this,a,b,c,"BRIGHTNESS");this.V=b};l.be=function(a,b,c){y(this,a,b,c,"NVR.LATCH");this.J=b};l.ae=function(a,b,c){y(this,a,b,c,"DC012");a=b&3;switch(b>>2&3){case 0:this.u=this.u&-4|a;break;case 1:this.u=this.u&-13|a<<2;this.video&&(b=this.video,a=this.u,Rb(b,"updateScrollOffset("+a+")"),b.qa!==a&&((b.qa=a)?yd(b,!0):b.ua=!0));break;case 2:switch(a){case 0:this.N=~this.N;break;case 2:case 3:this.W=3-a}break;case 3:this.U=a}};
l.$d=function(a,b,c){y(this,a,b,c,"DC011");b&J.Ha.hd?(b&=J.Ha.nc,this.G!=b&&(this.G=b,this.video&&(a=this.video,b=this.G==J.Ha.nc?50:60,Rb(a,"updateRate("+b+")"),a.eb=b))):(b&=J.Ha.Vb,this.F!=b&&(this.F=b,this.video&&(a=this.F==J.Ha.Vb?132:80,b=this.video,Rb(b,"updateDimensions("+a+","+(80<a&&this.D&J.va.hc?14:24)+")"),b.N=a,b.ea=b.Ba,80<a&&b.ea--,qe(b)&&re(b))))};
var ne={na:1978.1,nd:{oa:0,ef:1,kf:16,sf:32,Bf:64,Af:128,Ya:14},La:{oa:1,Nc:1,gd:2,cd:4,dd:16,ed:32,fd:64,Ya:8},od:{oa:2,df:3,Jf:4,ff:8,wf:16,xf:32,yf:64,gf:128,Ya:0},Ff:{oa:3},Df:{oa:2,tf:7},Hf:{oa:3,Kf:1,Gf:2,zf:4,qf:8,jf:16,ze:32},Ef:{oa:4},If:{oa:5,lf:1,mf:2,nf:4,pf:8,Lf:16}},J={na:100,va:{oa:66,rc:1,hc:2,bd:4,vf:8,uf:16,jc:32,ic:64,cc:128},Mc:{oa:66,INIT:0},Ha:{oa:194,Ce:0,Vb:16,hd:32,nc:48,Sc:0,Tc:32},qb:{oa:162,Cf:0,Vc:0,Rc:0,Uc:0,Qc:0},ya:{rf:{oa:98},Ga:{Kc:0,Jc:1,kd:2,pd:4,Pc:5,jd:6,ld:7},
rb:16383}},le={SI1978:ne,VT100:J};ne.INIT=[[ne.nd.Ya,ne.La.Ya,ne.od.Ya,0,0,0,0]];
J.INIT=[[J.Mc.INIT,J.va.hc|J.va.bd],[J.Ha.Sc,J.Ha.Tc],[J.qb.Vc,J.qb.Rc,J.qb.Uc,J.qb.Qc],[0,0,0,0,[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11776,11984,11888,11776,11808,11776,12E3,12E3,11901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11808,11984,11856,11776,11808,11776,12E3,12E3,11881,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]];ne.yb={0:ke.prototype.Hd,1:ke.prototype.Id,2:ke.prototype.Jd,3:ke.prototype.Gd};
ne.zb={2:ke.prototype.Ud,3:ke.prototype.Wd,4:ke.prototype.Vd,5:ke.prototype.Xd,6:ke.prototype.Yd};J.yb={66:ke.prototype.Kd};J.zb={66:ke.prototype.Zd,98:ke.prototype.be,162:ke.prototype.ae,194:ke.prototype.$d};hb(function(){for(var a=zb(document,"pc8080","chipset"),b=0;b<a.length;b++){var c=a[b],d=Ab(c);d=new ke(d);yb(d,c)}});
function se(a){t.call(this,"ROM",a);this.b=null;this.A=a.addr;this.g=a.size;this.u=a.alias;this.j=a.file;this.B=ya(this.j);if(this.j){a=this.j;var b=za(this.B);"json"!=b&&"hex"!=b&&(a=Ca()+"/api/v1/dump?file\x3d"+this.j+"\x26format\x3dbytes\x26decimal\x3dtrue");var c=this;Qa(a,null,!0,function(a,b,f){Oe(c,a,b,f)})}}ia(se,t);se.prototype.Da=function(a,b,c,d){this.H=b;this.w=c;this.I=d;Pe(this)};
se.prototype.ta=function(){if(this.pa){if(this.I){var a=this.I,b=this.id,c=this.A,d=this.g,e=this.pa,f=[],g;for(g in e){var h=e[g];"number"==typeof h&&(e[g]=h={o:h});var k=h.o,p=h.a;if(void 0!==k){var v=f;k=[k>>>0,g];var x=Ia(v,k,a.yc);0>x&&v.splice(-(x+1),0,k)}p&&(h.a=p.replace(/''/g,'"'))}a.C.push({Of:b,K:c,Od:d,pa:e,xc:f})}delete this.pa}return!0};se.prototype.sa=function(){return!0};
function Oe(a,b,c,d){if(d)a.Z("Unable to load system ROM (error "+d+": "+b+")");else{tb(a.Za,b,c);if("["==c.charAt(0)||"{"==c.charAt(0))try{var e=eval("("+c+")"),f=e.bytes,g=e.longs||e.data;if(f)a.b=f;else if(g)for(a.b=Array(4*g.length),d=c=0;c<g.length;c++)a.b[d++]=g[c]&255,a.b[d++]=g[c]>>8&255,a.b[d++]=g[c]>>16&255,a.b[d++]=g[c]>>24&255;else a.b=e;a.pa=e.symbols;if(!a.b.length){r("Empty ROM: "+b);return}if(1==a.b.length){r(a.b[0]);return}}catch(h){a.Z("ROM data error: "+h.message);return}else for(b=
c.replace(/\n/gm," ").replace(/ +$/,"").split(" "),a.b=Array(b.length),e=0;e<b.length;e++)a.b[e]=ta(b[e],16);Pe(a)}}
function Pe(a){if(!Mb(a))if(!a.j)Nb(a);else if(a.b&&a.H){a.g||(a.g=a.b.length);if(a.b.length!=a.g)Lb(a,"ROM size ("+n(a.b.length,8,!0)+") does not match specified size ("+n(a.g,8,!0)+")");else{var b=a.A;if(cc(a.H,b,a.g,Kc)){var c;for(c=0;c<a.b.length;c++)kc(a.H,b+c,a.b[c]);b=!0}else b=!1;if(b){b=[];"number"==typeof a.u?b.push(a.u):null!=a.u&&a.u.length&&(b=a.u);for(c=0;c<b.length;c++){for(var d=a,e=b[c],f=d.H,g=d.g,h=[],k=d.A>>>f.g;0<g&&k<f.b.length;)h.push(f.b[k++]),g-=f.u;f=d.H;d=d.g;g=0;for(e>>>=
f.g;0<d&&e<f.b.length;){k=h[g++];if(!k)break;f.b[e++]=k;d-=f.u}}delete a.b}}Nb(a)}}hb(function(){for(var a=zb(document,"pc8080","rom"),b=0;b<a.length;b++){var c=a[b],d=Ab(c);d=new se(d);yb(d,c)}});
function Qe(a){t.call(this,"RAM",a);this.pa=this.g=null;this.u=a.addr;this.A=a.size;this.Na=a.load;this.Fa=a.exec;this.j=!1;this.b=a.file;this.B=ya(this.b);if(this.b){a=this.b;var b=za(this.B);"json"!=b&&"hex"!=b&&(a=Ca()+"/api/v1/dump?file\x3d"+this.b+"\x26format\x3dbytes\x26decimal\x3dtrue");var c=this;Qa(a,null,!0,function(a,b,f){f?c.Z("Unable to load RAM resource (error "+f+": "+a+")"):(tb(c.Za,a,b),(a=Ra(a,b))?(c.g=a.ka,c.pa=a.pa,null==c.Na&&(c.Na=a.Na),null==c.Fa&&(c.Fa=a.Fa)):c.b=null,Re(c))})}}
ia(Qe,t);Qe.prototype.Da=function(a,b,c,d){this.H=b;this.w=c;this.I=d;Re(this)};Qe.prototype.ta=function(){return!0};Qe.prototype.sa=function(){return!0};
function Re(a){!a.j&&a.A&&cc(a.H,a.u,a.A,1)&&(a.j=!0);if(!Mb(a)){if(!a.j)r("No RAM allocated");else if(a.b){if(!a.g||!a.H)return;var b=a.u;null!==a.Na&&(b=a.Na);for(var c=0;c<a.g.length;c++)kc(a.H,b+c,a.g[c]);if(null!==a.Fa){if(a.Fa==Se){for(c=0;c<Te.length;c++)kc(a.H,Te[c],118);Cd(a.w,function(a){return function(b){if(0<=Te.indexOf(b)){var c=!1,d=a.w,e=a.I;if(b==Ue)switch(c=!0,d.A){case Ve:a.print(String.fromCharCode(d.C).replace(/\r/g,""));break;case We:for(var k=Jd(d),p="",v=255;v--;){var x=E(a.w,
k++);if(36==x)break;p+=String.fromCharCode(x)}a.print(p.replace(/\r/g,""));break;default:c=!1}c?ie.call(d):e&&(a.i("\nCP/M vector "+q(b)),B(d,b),Uc(e));b=!0}else b=!1;return b}}(a))}Ed(a.w,a.Fa)}delete a.g}Nb(a)}}Qe.prototype.reset=function(){};var Ue=5,Ve=2,We=9,Se=256,Te=[0,Ue];hb(function(){for(var a=zb(document,"pc8080","ram"),b=0;b<a.length;b++){var c=a[b],d=Ab(c);d=new Qe(d);yb(d,c)}});
function Xe(a){t.call(this,"Keyboard",a,65536);(a=a.model)&&!Ye[a]&&lb("Unrecognized Keyboard8080 model: "+a);this.b=Ye[a]||{};this.reset();Nb(this)}ia(Xe,t);l=Xe.prototype;
l.ca=function(a,b,c){var d=this,e=a+"-"+b;if(void 0===this.O[e]){if("led"==a&&this.b.$a[b])return this.O[e]=c,!0;switch(b){case "kbd":case "screen":return Xa("iOS")?(c.onkeypress=function(a){var b=!1;if(a=d.b.ob[a.keyCode||a.charCode]){a&128&&(a&=127,b=!0);a:{for(c in d.b.Pa)if(d.b.Pa[c]==a){var c=+c;break a}c=0}c&&(b?Ze(d,16,!0,!0):Ze(d,16,!1),Ze(d,c,!0,!0))}return!0},c.onkeydown=function(a){return $e(d,a,!0)},c.onkeyup=function(a){return $e(d,a,!1)}):(c.onkeydown=function(a){return af(d,a,!0)},
c.onkeyup=function(a){return af(d,a,!1)},c.onkeypress=function(a){a=a.keyCode||a.charCode;a>=m.Xa&&a<=m.sb?d.g&(bf|cf)||(d.g|=cf,Ze(d,20,!0),df(d)):a>=m.ub&&a<=m.z&&d.g&cf&&(d.g&=~cf,Ze(d,20,!1),df(d));return!0}),c.onpaste=function(a){a:{if(d.C&&d.C.Oa&&(a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a=a.clipboardData||window.clipboardData)){ef(d.C,a.getData("Text"));a=!1;break a}a=!0}return a},!0;default:if(this.b.Ra&&void 0!==this.b.Ra[b])return this.O[e]=c,c.onclick=
function(a,b){return function(d){d.preventDefault&&d.preventDefault();d=!0;var e=0;17==b?e=ff:20==b&&(e=cf);if(e){c.style.fontWeight="normal";if(d=!(a.g&e))c.style.fontWeight="bold";gf(a,b,d)}Ze(a,b,d,!e);a.P&&a.P.Va()}}(this,this.b.Ra[b]),!0}}return!1};l.Da=function(a,b,c,d){this.P=a;this.w=c;this.I=d;var e=this;this.J=td(this.w,this.id,function(){hf(e)});this.V=Zb(a,"ChipSet");this.C=Zb(a,"SerialPort");pc(b,this,this.b.yb);Cc(b,this,this.b.zb)};
l.ta=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};l.sa=function(a){return a?this.save():!0};l.reset=function(){this.j=[];this.g=0;this.b.INIT&&!this.restore(this.b.INIT)&&this.Z("reset error")};l.save=function(){var a=new Gd(this);switch(this.b.na){case K.na:a.set(0,[this.D,this.B,this.A,this.F,-1])}return a.data()};
l.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.b.na){case jf.na:return!0;case K.na:return this.D=b[0],df(this,this.D&K.za.dc),this.B=b[1],this.A=b[2],this.F=b[3],this.u=b[4],!0}return!1};function df(a,b){null!=b?a.G=b:b=a.G;for(var c in a.b.$a){var d="led-"+c;if(d=a.O[d]){var e=a.b.$a[c],f=!!(b&e);e&e-1&&(f=!(b&~e));d.style.backgroundColor=f?"#"+n(16711680,6):"#000000"}}if(d=a.O["led-caps-lock"])d.style.backgroundColor=a.g&cf?"#"+n(65280,6):"#000000"}
function gf(a,b,c,d){var e=0;switch(b){case 16:e=d?kf:lf;break;case 17:e=d?mf:ff;break;case 18:e=d?nf:of;break;case 91:e=d?pf:qf;break;case 20:e=cf,c=!(a.g&e)}e&&(a.g=c?a.g|e:a.g&~e);return c}
function af(a,b,c){var d=!0,e=b.keyCode;e=sa[e]||e;c=gf(a,e,c,2==b.location);a:if(e=a.b.Sb[e]||e,a.b.Pa[e])var f=e;else{for(f in a.b.Ra)if(a.b.Ra[f]===e)break a;f=null}f&&!b.metaKey&&(d=!1,a.g&(rf|sf)&&(13==f?(f=118,d=!0):8==f&&(f=46,d=!0),d&&(a.g=c?a.g|sf:a.g&~sf)),d=Ze(a,f,c),(!(f>=m.Xa&&f<=m.sb)||a.g|tf)&&b.preventDefault&&b.preventDefault());return d}
function $e(a,b,c){var d=!0;if(c){var e=b.keyCode,f=a.b.Pa[e],g;if(g=f){a:{for(var h in a.b.ob)if(a.b.ob[h]==f){f=+h;break a}f=0}g=!f}g&&(d=Ze(a,e,c,!0),b.preventDefault&&b.preventDefault())}return d}
function Ze(a,b,c,d){var e;a:{for(e=0;e<a.j.length;e++)if(a.j[e].Nb==b)break a;e=-1}if(c)0>e?a.j.push({Nb:b,Kb:Date.now(),vb:d||!1}):(a.j[e].Kb=Date.now(),a.j[e].vb=d||!1),d&&hf(a);else if(0<=e){if(!a.j[e].vb&&(d=a.j[e].Kb)&&Date.now()-d<uf)return a.j[e].vb=!0,hf(a),!0;a.j.splice(e,1)}if(a.V){d=0;switch(b){case "1p":d=ne.La.cd;break;case "2p":d=ne.La.gd;break;case "coin":d=ne.La.Nc;break;case "left":d=ne.La.ed;break;case "right":d=ne.La.fd;break;case "fire":d=ne.La.dd}d&&(a=a.V,b=d,a.A&=~b,c&&(a.A|=
b))}return!0}function hf(a){for(var b=0,c=-1;b<a.j.length;){if(a.j[b].vb){var d=a.j[b].Nb,e=uf-(Date.now()-a.j[b].Kb);if(0<e){if(0>c||c>e)c=e}else{Ze(a,d,!1);b=0;continue}}b++}0<=c&&ud(a.w,a.J,c)}l.Ld=function(a,b){var c=this.B;0<=this.u&&(this.u<this.j.length?(c=this.j[this.u],this.u++,c=K.Pa[c.Nb],c&128&&(c&=127)):(this.u=-1,c=K.Wc),this.B=c,de(this.w,1));y(this,a,null,b,"KBDUART.ADDRESS",c);return c};
l.ce=function(a,b,c){y(this,a,b,c,"KBDUART.STATUS");this.D=b;this.A=!0;this.F=dd(this.w);df(this,b&K.za.dc);b&K.za.md&&(this.u=0,de(this.w,1))};var kf=1,lf=2,bf=3,mf=4,ff=8,tf=12,nf=16,of=32,rf=48,pf=64,qf=128,cf=512,sf=4096,uf=50,vf={};vf[m.Xa]=37;vf[m.Cb]=39;vf[m.Eb]=32;
var jf={na:1978.1,Pa:{},ob:{},Sb:vf,$a:{},Ra:{"1p":49,"2p":50,coin:51,left:37,right:39,fire:32}},L={},M={},K={na:100,Pa:(L[8]=3,L[m.lc]=5,L[m.kc]=6,L[m.wc]=7,L[m.pc]=8,L[m.tc]=9,L[m.Q]=10,L[39]=16,L[221]=20,L[219]=21,L[m.$b]=22,L[m.qc]=23,L[m.mc]=24,L[m.E]=25,L[49]=26,L[37]=32,L[40]=34,L[117]=35,L[19]=35,L[192]=36,L[189]=37,L[57]=38,L[55]=39,L[52]=40,L[51]=41,L[27]=42,L[38]=48,L[114]=49,L[112]=50,L[46]=51,L[187]=52,L[48]=53,L[56]=54,L[54]=55,L[53]=56,L[50]=57,L[9]=58,L[103]=64,L[115]=65,L[113]=66,
L[96]=67,L[118]=68,L[220]=69,L[m.Eb]=70,L[m.bc]=71,L[m.Yb]=72,L[m.Xb]=73,L[m.Xa]=74,L[104]=80,L[2013]=81,L[98]=82,L[97]=83,L[222]=85,L[186]=86,L[m.ac]=87,L[m.Zb]=88,L[m.Cb]=89,L[m.oc]=90,L[110]=96,L[116]=97,L[101]=98,L[100]=99,L[13]=100,L[190]=101,L[188]=102,L[m.gc]=103,L[m.Tb]=104,L[m.vc]=105,L[119]=106,L[105]=112,L[99]=113,L[102]=114,L[109]=115,L[191]=117,L[m.fc]=118,L[m[" "]]=119,L[m.sc]=120,L[m.Ub]=121,L[m.sb]=122,L[120]=123,L[17]=124,L[16]=125,L[20]=126,L),ob:(M[m.p]=5,M[m.Qd]=6,M[m.y]=7,M[m.t]=
8,M[m.qe]=9,M[m.q]=10,M[m["]"]]=20,M[m["["]]=21,M[m.Dd]=22,M[m.oe]=23,M[m.r]=24,M[m.e]=25,M[m["1"]]=26,M[m["`"]]=36,M[m["-"]]=37,M[m["9"]]=38,M[m["7"]]=39,M[m["4"]]=40,M[m["3"]]=41,M[m["\x3d"]]=52,M[m["0"]]=53,M[m["8"]]=54,M[m["6"]]=55,M[m["5"]]=56,M[m["2"]]=57,M[m["\\"]]=69,M[m.Nd]=70,M[m.k]=71,M[m.Bd]=72,M[m.zd]=73,M[m.ub]=74,M[m["'"]]=85,M[m[";"]]=86,M[m.Md]=87,M[m.Cd]=88,M[m.d]=89,M[m.me]=90,M[13]=100,M[m["."]]=101,M[m[","]]=102,M[m.n]=103,M[m.sd]=104,M[m.x]=105,M[m["/"]]=117,M[m.Pd]=118,M[m.pe]=
120,M[m.vd]=121,M[m.z]=122,M[m.lc]=133,M[m.kc]=134,M[m.wc]=135,M[m.pc]=136,M[m.tc]=137,M[m.Q]=138,M[m["}"]]=148,M[m["{"]]=149,M[m.$b]=150,M[m.qc]=151,M[m.mc]=152,M[m.E]=153,M[m["!"]]=154,M[m["~"]]=164,M[m._]=165,M[m["("]]=166,M[m["\x26"]]=167,M[m.$]=168,M[m["#"]]=169,M[m["+"]]=180,M[m[")"]]=181,M[m["*"]]=182,M[m["^"]]=183,M[m["%"]]=184,M[m["@"]]=185,M[m["|"]]=197,M[m.Eb]=198,M[m.bc]=199,M[m.Yb]=200,M[m.Xb]=201,M[m.Xa]=202,M[m['"']]=213,M[m[":"]]=214,M[m.ac]=215,M[m.Zb]=216,M[m.Cb]=217,M[m.oc]=218,
M[m["\x3e"]]=229,M[m["\x3c"]]=230,M[m.gc]=231,M[m.Tb]=232,M[m.vc]=233,M[m["?"]]=245,M[m.fc]=246,M[m.sc]=248,M[m.Ub]=249,M[m.sb]=250,M),Sb:{},$a:{},Ra:{"caps-lock":20,ctrl:17,esc:27,tab:9,"num-comma":116,"break":117,"line-feed":118,"no-scroll":119,setup:120},Lc:{oa:130,INIT:127},za:{oa:130,$c:1,Zc:2,Yc:4,Xc:8,ad:16,ec:32,dc:63,md:64,Be:128,INIT:0},Wc:127};K.$a={l4:K.za.$c,l3:K.za.Zc,l2:K.za.Yc,l1:K.za.Xc,locked:K.za.ad,local:K.za.ec,online:~K.za.ec,"caps-lock":cf};var Ye={SI1978:jf,VT100:K};
K.INIT=[[K.za.INIT,K.Lc.INIT,!1,0,-1]];K.yb={130:Xe.prototype.Ld};K.zb={130:Xe.prototype.ce};hb(function(){for(var a=zb(document,"pc8080","keyboard"),b=0;b<a.length;b++){var c=a[b],d=Ab(c);d=new Xe(d);yb(d,c)}});
function wf(a,b,c,d,e){t.call(this,"Video",a,262144);var f=this;this.Qa=Xa("Gecko/");this.L=a.screenWidth;this.G=a.screenHeight;this.ja=a.bufferAddr;this.td=a.bufferRAM;var g=a.bufferFormat;this.X=g&&xf[g.toUpperCase()]||yf;this.N=a.bufferCols;this.Y=a.bufferRows;this.Ba=this.ea=a.cellWidth||1;this.ba=a.cellHeight||1;this.aa=null;this.Ka=!1;this.la=a.bufferBits||1;this.wd=a.bufferLeft||0;if(this.g=a.bufferRotate)this.g=this.g%360,0<this.g&&(this.g-=360),-90!=this.g&&(this.Z("unsupported buffer rotation: "+
this.g),this.g=0);this.ma=a.interruptRate;this.fb=a.refreshRate||60;this.F=b;this.j=c;this.U=(this.Ad=d)||b||null;this.Ab=this.L;this.rd=this.G;this.Ia=this.L/this.N|0;this.Ja=this.G/this.Y|0;1<this.ba&&(this.Y++,this.qa=0,this.ua=!1);b=a.smoothing;(c=$a("smoothing"))&&(b="true"==c);null!=b&&(c=Ya(this.j,"imageSmoothingEnabled"))&&(this.j[c]=b);if(this.u=a.screenRotate)this.u=this.u%360,0<this.u&&(this.u-=360),-90!=this.u?(this.Z("unsupported screen rotation: "+this.u),this.u=0):(this.j.translate(0,
this.G),this.j.rotate(this.u*Math.PI/180),this.j.scale(this.G/this.L,this.L/this.G));if(this.b=e)if(c=Ya(e,"requestFullscreen")||Ya(e,"requestFullScreen")){this.b.ib=e[c];if(e=Ya(document,"on","fullscreenchange")){var h=Ya(document,"fullscreenElement")||Ya(document,"fullScreenElement");document.addEventListener(e,function(){zf(f,!!h)},!1)}(e=Ya(document,"on","fullscreenerror"))&&document.addEventListener(e,function(){zf(f,null)},!1)}if(this.R=a.fontROM)"json"!=za(this.R)&&(this.R=Ca()+"/api/v1/dump?file\x3d"+
this.R+"\x26format\x3dbytes"),Qa(this.R,null,!0,function(a,b,c){Af(f,a,b,c)});this.xa={}}ia(wf,t);
function qe(a){a.C=a.N*a.ea;a.M=a.Y*a.ba;var b=a.C,c=a.M;a.g&&(b=a.M,c=a.C);a.J=0;if(!a.td&&(a.J=(a.C*a.la>>3)*a.M,!cc(a.H,a.ja,a.J,3)))return!1;a.J?(a.Sa=a.j.createImageData(b,c),a.bb=16/a.la|0,Bf(a,a.J>>1)):Bf(a,(a.N+1)*a.Y);a.D=document.createElement("canvas");a.D.width=b;a.D.height=c;a.ra=a.D.getContext("2d");a.S={};a.W=1<<a.la;a.T=Array(a.W+Cf);a.T[0]=[0,0,0,255];a.T[1]=[255,255,255,255];a.X==Df&&(a.T[a.W+Ef]=[255,255,0,255],a.T[a.W+Ff]=[0,255,0,255]);a.X==Gf&&(a.eb=60,a.wa=!1,a.da=Array(a.N));
return!0}l=wf.prototype;l.ca=function(a,b,c){var d=this;if("led"==a||"rled"==a)return this.xa[b]=c,!0;switch(b){case "fullScreen":return this.O[b]=c,this.b&&this.b.ib?c.onclick=function(){d.ib()}:c.parentNode.removeChild(c),!0}return!1};
l.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.I=d;qe(this);if(this.B=Zb(a,"Keyboard")){for(var e in this.xa)this.B.ca("led",e,this.xa[e]);this.F&&this.B.ca(this.Ad?"textarea":"canvas","screen",this.U)}var f=this;this.tb=td(this.w,this.id,function(){yd(f)});ud(this.w,this.tb,1E3/Math.max(this.fb,this.ma));this.cb=0;this.R||Nb(this)};
function Af(a,b,c,d){if(d)a.Z("Unable to load font ROM (error "+d+": "+b+")");else{tb(a.Za,b,c);try{var e=eval("("+c+")"),f=e.bytes||e;if(!f||!f.length){r("Empty font ROM: "+b);return}if(1==f.length){r(f[0]);return}if(2048==f.length)a.aa=f,re(a);else{a.Z("Unrecognized font data length ("+f.length+")");return}}catch(g){a.Z("Font ROM data error: "+g.message);return}(a.j||a.I)&&Nb(a)}}
function re(a){a.aa&&(a.Ka=a.X==Gf,a.S[Hf]=[If(a,a.ea,a.ba),If(a,a.ea,a.ba,a.wa)],a.S[Jf]=[If(a,2*a.ea,a.ba),If(a,2*a.ea,a.ba,a.wa)],a.S[Kf]=a.S[Lf]=[If(a,2*a.ea,2*a.ba),If(a,2*a.ea,2*a.ba,a.wa)])}
function If(a,b,c,d){var e=8>=a.Ba?8:16,f=8<e?15:0,g=a.aa.length/e,h=!1===d,k={ea:b,ba:c};k.canvas=document.createElement("canvas");k.canvas.width=16*b;k.canvas.height=g/16*c;k.context=k.canvas.getContext("2d");for(var p=k.context.createImageData(b,c),v=0;v<g;v++){for(var x=0,z=x;x<a.ba;x++){var u=v*e+(f+x&e-1);u=d&&8==x?255:a.aa[u];for(var w=0;w<c/a.ba;w++){for(var D=0,T=0,Na=T;T<a.ea;T++){var P=u&128>>(7<T?7:T);D=a.Ka&&!P&&D?D:P;for(var ob=0;ob<b/a.ea;ob++)h&&(D=!D),Mf(a,p,Na,z,D?1:0),Na++;D=P}z++}}k.context.putImageData(p,
(v&15)*b,(v>>4)*c)}return k}l.ta=function(a,b){return b||!a||this.restore(a)?!0:!1};l.sa=function(a){return!a||this.save()};l.save=function(){var a=new Gd(this);a.set(0,[]);return a.data()};l.restore=function(){return!0};
l.ib=function(){var a=!1;if(this.b){if(this.b.ib){a="100%";if(screen&&screen.width&&screen.height){var b=screen.width/screen.height,c=this.L/this.G;b>c&&(a=Math.round(c/b*100)+"%")}this.Qa?(this.F.style.width=a,this.F.style.width=a,this.F.style.display="block",this.F.style.margin="auto"):(this.b.style.width=a,this.b.style.height="auto");this.b.style.backgroundColor="black";this.b.ib();a=!0}this.U&&this.U.focus()}return a};
function zf(a,b){!b&&a.b&&(a.Qa?a.F.style.width=a.F.style.height="":a.b.style.width=a.b.style.height="");Rb(a,"notifyFullScreen("+b+")")}function Bf(a,b){a.ab=b;a.V=!1;if(void 0===a.A||a.A.length!=a.ab)a.A=Array(a.ab)}function Mf(a,b,c,d,e){d=a.g?(b.height-c-1)*b.width+d:c+d*b.width;e&&a.X==Df&&(208<=c&&236>c?e=a.W+Ef:28<=c&&72>c&&(e=a.W+Ff));a=a.T[e];d*=a.length;b.data[d]=a[0];b.data[d+1]=a[1];b.data[d+2]=a[2];b.data[d+3]=a[3]}
function yd(a,b){var c=!0;if(!b){a.ma&&(120==a.ma?a.cb&1?(de(a.w,2),c=!1):de(a.w,1):de(a.w,4));if(c&&a.V&&a.J){var d=a.H,e=a.ja,f=a.J,g=!0,h=e>>>d.g;for(e=d.u-(e&d.j);0<f&&h<d.b.length;)d.b[h].Ca&&(d.b[h].Ca=g=!1,d.b[h].Bc=!0),f-=e,e=d.u,h++;g&&(c=!1)}ud(a.w,a.tb,1E3/Math.max(a.fb,a.ma));a.cb++}if(c)if(1<a.ea)switch(a.X){case Gf:c=a.ja;d=-1;f=0;g=60==a.eb?2:5;e=h=0;for(var k=-1;f<a.Y;){var p=0,v=c,x=d,z=a.N;for(x!=Hf&&(z>>=1);;){var u=hc(a.H,v++);if((u&Nf)==Nf){var w=hc(a.H,v++);d=w&Of;c=(w&Pf)<<
8|hc(a.H,v);c+=w&Qf?Rf:Sf;break}if(p<z)a.da[p++]=u;else break}if(g)g--;else{for(;p<a.da.length;)a.da[p++]=0;if(0<=x)for(v=a.V&&a.A[h]==z,a.A[h++]=z,z=0;z<p;z++){u=a.da[z];if(!v||u!==a.A[h]){a.A[k=h]=u;w=a;var D=a.ra;var T=u&127;if(u=w.S[x][u&128?1:0]){var Na=(T&15)*u.ea,P=(T>>4)*u.ba,ob=u.ea,Oa=u.ba;if(D){var ua=z*w.ea;var ma=f*w.ba;var va=w.ea;T=w.ba}else ua=z*w.Ia,ma=f*w.Ja,va=w.Ia,T=w.Ja;u.ea>w.ea&&(ua*=2,va*=2);u.ba>w.ba&&(x==Lf&&(P+=w.ba),Oa=w.ba);D?D.drawImage(u.canvas,Na,P,ob,Oa,ua,ma,va,T):
(ua+=0,ma+=0,w.j.drawImage(u.canvas,Na,P,ob,Oa,ua,ma,va,T))}e++}h++}f++}}a.V=!0;!b&&a.ua&&1==e&&(a.A[k]=-1,e=0);a.ua=!1;(e||b)&&a.ra&&a.j.drawImage(a.D,0,a.qa,a.C,a.M-a.ba,0,0,a.Ab,a.rd)}else{f=a.ja;g=f+a.J;k=e=h=0;b=a.C;p=0;c=a.M;x=d=0;v=a.la;z=(1<<v)-1;a.wd&&(v=-v,x=16+v);for(;f<g;){w=jc(a.H,f);if(a.V&&w===a.A[h])e+=a.bb;else{a.A[h]=w;(D=x)&&(w=w>>8|(w&255)<<8);e<b&&(b=e);for(u=a.bb;u--;)Na=w>>D&z,Mf(a,a.Sa,e++,k,Na),D+=v;e>p&&(p=e);k<c&&(c=k);k>=d&&(d=k+1)}f+=2;h++;if(e>=a.C&&(e=0,k++,k>a.M))break}a.V=
!0;b<a.C&&(f=p-b,d-=c,a.g&&(g=b,h=f,b=c,f=d,c=a.C-(g+h),d=h),a.ra.putImageData(a.Sa,0,0,b,c,f,d),a.j.drawImage(a.D,0,0,a.D.width,a.D.height,0,0,a.L,a.G))}}var Ef=0,Ff=1,Cf=2,yf=0,Df=1,Gf=2,xf={SI1978:Df,VT100:Gf},Hf=96,Jf=64,Kf=32,Lf=0,Nf=127,Pf=15,Qf=16,Of=96,Rf=8192,Sf=16384;
hb(function(){for(var a=zb(document,"pc8080","video"),b=0;b<a.length;b++){var c=a[b],d=Ab(c),e=document.createElement("canvas");if(void 0===e||!e.getContext){c.innerHTML="\x3cbr/\x3eMissing \x26lt;canvas\x26gt; support. Please try a newer web browser.";break}e.setAttribute("class","pcjs-canvas");e.setAttribute("width",d.screenWidth);e.setAttribute("height",d.screenHeight);e.style.backgroundColor=d.screenColor;e.style.height="auto";0<=Sa().indexOf("MSIE")&&(c.onresize=function(a,b,c,d){return function(){b.style.height=
(a.clientWidth*d/c|0)+"px"}}(c,e,d.screenWidth,d.screenHeight),c.onresize());var f=+(d.aspect||$a("aspect"));f&&.3<=f&&3.33>=f&&(gb("onresize",function(a,b,c){return function(){b.style.height=(a.clientWidth/c|0)+"px"}}(c,e,f)),window.onresize());c.appendChild(e);f=document.createElement("textarea");Xa("iOS")&&(f.setAttribute("autocapitalize","off"),f.setAttribute("autocorrect","off"),f.style.fontSize="16px");c.appendChild(f);var g=e.getContext("2d");d=new wf(d,e,g,f,c);yb(d,c)}});
function Tf(a){t.call(this,"SerialPort",a,8388608);this.S=+a.adapter;switch(this.S){case 0:this.T=0;this.W=2;break;default:r("Unrecognized serial adapter #"+this.S);return}this.g=this.j=null;this.U=a.tabSize;this.R=a.charBOL;this.u=0;this.M=!1;this.D=!0;var b=a.binding;if("console"==b)this.j="";else{a=Uf;var c;b&&(void 0===c&&(c="Panel"),(c=Eb(c,this.id))&&(b=c.O[b])&&this.ca(null,a,b))}this.A="";this.b=this.Oa=this.G=null;this.exports={connect:this.Dc,receiveData:this.Mb,receiveStatus:this.le}}
ia(Tf,t);l=Tf.prototype;l.ca=function(a,b,c,d){var e=this;switch(b){case Uf:return this.O[b]=this.g=c,c.onkeydown=function(a){a=a||window.event;var b=a.keyCode;if(8===b||a.ctrlKey&&65<=b&&90>=b)a.preventDefault&&a.preventDefault(),64<b&&(b-=64),Vf(e,b);return!0},c.onkeypress=function(a){a=a||window.event;Vf(e,a.which||a.keyCode);a.preventDefault&&a.preventDefault();return!0},c.removeAttribute("readonly"),!0;default:if(d)return this.O[b]=c,c.onclick=function(){e.Mb(d);return!0},!0}return!1};
l.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.I=d;var e=this;this.X=td(this.w,this.id+".receive",function(){e.Mb()});this.Y=td(this.w,this.id+".transmit",function(){ef(e)});this.V=Zb(a,"ChipSet");pc(b,this,Wf,this.T);Cc(b,this,Xf,this.T);Nb(this)};
l.Dc=function(a){if(!this.b){var b=Xc(this.P,"connection");if(b){var c=b.split("-\x3e");if(2==c.length){var d=Ga(c[0]);if(d!=this.Fb)return;c=Ga(c[1]);if(this.b=Db(c)){var e=this.b.exports;if(e){var f=e.connect;f&&f.call(this.b,this.D);if(this.Oa=e.receiveData){this.D=a;this.G=e.receiveStatus;this.status("Connected "+this.Za+"."+d+" to "+c);return}}}}this.status("Unable to establish connection: "+b)}}};
l.ta=function(a,b){if(!b)if(this.Dc(this.D),!a||!this.restore)this.reset();else if(!this.restore(a))return!1;return!0};l.sa=function(a){return a?this.save():!0};l.reset=function(){Yf(this)};l.save=function(){var a=new Gd(this),b=0,c=[];c[b++]=this.F;c[b++]=this.L;c[b++]=this.N;c[b++]=this.ga;c[b++]=this.B;c[b++]=this.C;c[b]=this.J;a.set(0,c);return a.data()};l.restore=function(a){return Yf(this,a[0])};
function Yf(a,b){var c=0;void 0===b&&(b=Zf);a.F=b[c++];a.L=b[c++];a.N=b[c++];a.ga=b[c++];a.B=b[c++];a.C=b[c++];a.J=b[c];return!0}function $f(a,b){var c=a.J&b;b&15||(c>>=4);b=ag[c];c=((a.B&bg)>>2)+6;a.B&cg&&c++;c+=((a.B&dg)>>6)+1>>1;return 1E3/(b/c)|0}function Vf(a,b){Rb(a,"receiveByte("+xa(b)+"), status\x3d"+xa(a.ga));return a.M||a.ga&eg?!1:(a.L=b,a.ga|=eg,de(a.w,a.W),!0)}
l.Mb=function(a){null!=a&&(this.A="number"!=typeof a?a:this.A+String.fromCharCode(a));this.A&&(Vf(this,this.A.charCodeAt(0))&&(this.A=this.A.substr(1)),this.A&&this.w&&ud(this.w,this.X,$f(this,fg)));return!0};l.le=function(a){this.ga&=~gg;a&64&&(this.ga|=gg)};function ef(a,b){a.ga=a.ga|pe|hg;b&&a.Oa&&a.Oa.call(a.b,b)}l.Fd=function(a,b){var c=this.L;y(this,a,null,b,"DATA",c);this.ga&=~eg;return c};l.Ed=function(a,b){var c=this.ga;y(this,a,null,b,"STATUS",c);return c};
l.Td=function(a,b,c){y(this,a,b,c,"DATA");this.N=b;this.ga&=~(pe|hg);Rb(this,"transmitByte("+xa(b)+")");if(19==b)this.M=!0;else if(17==b)this.M=!1;else if(this.Oa&&this.Oa.call(this.b,b),this.g)if(8==b)this.g.value=this.g.value.slice(0,-1),0<this.u&&this.u--;else{var d;13!=b&&10!=b&&(d=Ha[b]);a=d=d?"\x3c"+d+"\x3e":String.fromCharCode(b);c=a.length;9==b?(b=this.U||8,c=b-this.u%b,this.U&&(a=Fa("",c))):13==b&&(this.u=c=0,a="\n");this.R&&!this.u&&c&&(a=String.fromCharCode(this.R)+a);this.g.value+=a;this.g.scrollTop=
this.g.scrollHeight;this.u+=c}else if(null!=this.j){if(10==b||1024<=this.j.length)this.i(this.j),this.j="";10!=b&&(this.j+=String.fromCharCode(b))}this.w&&ud(this.w,this.Y,$f(this,ig))};l.Sd=function(a,b,c){y(this,a,b,c,"CONTROL");this.F?(this.G&&(b^this.C)&(jg|kg)&&(a=0,this.D?(a|=b&jg?32:0,a|=b&kg?320:0):(a|=b&jg?16:0,a|=b&kg?1048576:0),this.G.call(this.b,a)),this.C=b,this.C&lg&&(this.F=!1)):(this.B=b,this.F=!0)};l.Rd=function(a,b,c){y(this,a,b,c,"BAUDRATES");this.J=b};
var bg=12,cg=16,dg=192,kg=2,jg=32,lg=64,pe=1,eg=2,hg=4,gg=128,fg=15,ig=240,ag=[50,75,110,134.5,150,200,300,600,1200,1800,2E3,2400,3600,4800,9600,19200],Zf=[!1,0,0,133,142,39,238],Uf="buffer",Wf={0:Tf.prototype.Fd,1:Tf.prototype.Ed},Xf={0:Tf.prototype.Td,1:Tf.prototype.Sd,2:Tf.prototype.Rd};hb(function(){for(var a=zb(document,"pc8080","serial"),b=0;b<a.length;b++){var c=a[b],d=Ab(c);d=new Tf(d);yb(d,c)}});
function mg(a){t.call(this,"Debugger",a);this.u=+a.base||16;this.T=["{","}"];this.da=["[","]"];this.R=this.aa=this.F=0;this.M=!1;this.b=-1;this.g=[];this.A={}}ia(mg,t);mg.prototype.Ib=function(){return-1};mg.prototype.Jb=function(){};
mg.prototype.xb=function(a,b,c){if(b)if(a){0>this.b&&this.g.length&&(this.b=0);if(0>this.b||a!=this.g[this.b])this.g.splice(0,0,a),this.b=0;this.b--}else this.M?a="end":a=this.g[this.b+1];b=[];if(a){a=a.replace(/""/g,"'");var d=0,e=null;c=c||";";for(var f=0;f<=a.length;f++){var g=a.charAt(f);if('"'==g||"'"==g)e?g==e&&(e=null):e=g;else if(g==c&&!e||!g)b.push(Ga(a.substring(d,f))),d=f+1}}return b};
function ng(a,b,c){var d=a;b=b||32;if(c)if(32==b)d=a>>>0;else if(32>b)d=a&(1<<b)-1;else{if(b=Math.pow(2,b),0>a||a>=b)d=a%b,0>d&&(d+=b)}else 32>=b?d=a<<32-b>>32-b:(b=Math.pow(2,b-1),a>=b?(d=a%b,(a/b|0)&1&&(d-=b)):a<-b&&(d=a%b,((-a-1)/b|0)&1?d&&(d+=b):d||(d-=b)));a!=d&&(a=d);return a}
function og(a,b,c){for(c=void 0===c?-1:c;c--&&b.length;){var d=b.pop();if(2>a.length)return!1;var e=a.pop();var f=a.pop();switch(d){case "*":f*=e;break;case "/":if(!e)return!1;f=Math.trunc(f/e);break;case "^/":if(!e)return!1;f%=e;break;case "+":f+=e;break;case "-":f-=e;break;case "\x3c\x3c":f<<=e;break;case "\x3e\x3e":f>>=e;break;case "\x3e\x3e\x3e":f>>>=e;break;case "\x3c":f=f<e?1:0;break;case "\x3c\x3d":f=f<=e?1:0;break;case "\x3e":f=f>e?1:0;break;case "\x3e\x3d":f=f>=e?1:0;break;case "\x3d\x3d":f=
f==e?1:0;break;case "!\x3d":f=f!=e?1:0;break;case "\x26":f&=e;break;case "!":case "|":f|=e;break;case "^!":f|=e;break;case "\x26\x26":f=f&&e?1:0;break;case "||":f=f||e?1:0;break;case ",,":f=ng(f,18,!0)*Math.pow(2,18)+ng(e,18,!0);break;case "_":case "^_":"^_"==d&&(e=35-(e&255));e&&(f=ng(f,0,!0),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));break;default:return!1}a.push(ng(f))}return!0}
function pg(a,b,c,d,e,f){var g,h=!1,k=0,p=[],v=[],x=a.u;for(a.u=e;c<d;){var z=b[c++].trim();var u=c<d?b[c++]:"";if(z)var w=qg(a,z,null,f,k);else if("{"==u){z=1;for(w=c;c<d;)if(c++,u=c<b.length?b[c++]:"","{"==u)z++;else if("}"==u&&!--z)break;w=pg(a,b,w,c-1,a.u,f);null!=w&&k&&(w=rg(w,k));z=c<d?b[c++].trim():"";u=c<d?b[c++]:""}else{if(" "==u)continue;if("^B"==u){a.u=2;continue}if("^O"==u){a.u=8;continue}if("^D"==u){a.u=10;continue}if(!(k&-1073741824)){if("+"==u)continue;if("-"==u){k=k<<2|1;continue}if("~"==
u||"^-"==u){k=k<<2|2;continue}if("^L"==u){k=k<<2|3;continue}}h=!0;break}if(void 0===w)if(f)f.push(z),w=0;else{h=!0;f=[];break}p.push(ng(w));if(" "==u)if(c<b.length-1&&!b[c])c++,u=b[c++];else{h=!0;break}if(!u)break;k="\x3c"==a.T[0]?sg:tg;if(!k[u]){h=!0;break}v.length&&k[u]<=k[v[v.length-1]]&&og(p,v,1);v.push(u);a.u="^_"==u?10:e;k=0}if(h||!og(p,v)||1!=p.length)h=!0;h?f||a.i("parse error ("+(z||u)+")"):g=p.pop();a.u=x;return g}
function ug(a,b,c,d,e){for(var f;0<=(f=b.indexOf(c));){for(var g=0,h=f+1,k=e;h<b.length;){var p=b[h++];if(p==c){k=-1;break}if(!k)break;k--;p=p.charCodeAt(0);7==d?p&=127:p=p-32&63;g=ng(g*Math.pow(2,d)+p,d*e,!0)}if(0<=k){a.i("parse error ("+c+b+c+")");return}b=b.substr(0,f)+vg(a,g,-1)+b.substr(h)}return b}
function wg(a,b,c){var d=void 0,e=!1===c;c=Array.isArray(c)?c:void 0;if(b){"{"!=a.T[0]&&(b=b.split(a.T[0]).join("{").split(a.T[1]).join("}"));b=ug(a,b,'"',7,5);if(!b)return d;b=ug(a,b,"'",6,6);if(!b)return d;16!=a.u&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);d=pg(a,b,0,b.length,a.u,c);void 0!==d&&e&&xg(a,null,d)}return d}
function yg(a,b){var c=a.T[0],d=a.T[1];var e="("==c||"{"==c||"["==c?"\\":"";var f="["==c?"\\":"";for(f=new RegExp(e+c+"([^"+f+c+f+d+"]+)"+e+d);e=b.match(f);){var g=wg(a,e[1]);if(void 0===g)return;b=b.replace(c+e[1]+d,null!=g?vg(a,g):"undefined")}if(a.da.length)for(c=a.da[0],d=a.da[1],e="("==c||"{"==c||"["==c?"\\":"",f="["==c?"\\":"",f=new RegExp(e+c+"([^"+f+c+f+d+"]+)"+e+d);e=b.match(f);)b=b.replace("["+e[1]+"]","unimplemented");for(;c=b.match(/\$([a-z]+)/i);){d=null;switch(c[1].toLowerCase()){case "ops":d=
a.R-a.aa}if(null==d)break;b=b.replace(c[0],d.toString())}return b}function rg(a,b){for(;b;){switch(b&3){case 1:a=-ng(a);break;case 2:a|=-1;break;case 3:for(var c=35;0<=c&&!(a&Math.pow(2,c));)c--;a=35-c}b>>>=2}return a}
function qg(a,b,c,d,e){e=void 0===e?0:e;var f=Array.isArray(d)?d:void 0;if(null!=b){var g=a.Ib(b);if(0<=g)g=a.Jb(g);else if(g=b,a.A[g]?g=a.A[g].value:(g=g.substr(0,6),g=a.A[g]&&a.A[g].value),null!=g){var h=a.A[b]&&a.A[b].ne;h&&(f?f.push(h):(f=wg(a,h,d),void 0!==f?g+=f:(d||a.i("undefined "+(c||"value")+": "+b+" ("+h+")"),g=void 0)))}else g=ta(b,1<b.length||10<a.u?a.u:10);null!=g?g=ng(rg(g,e)):d||a.i("invalid "+(c||"value")+": "+b)}else d||a.i("missing "+(c||"value"));return g}
function xg(a,b,c){var d=!1;if(void 0!==c){d=!0;var e=8==a.u?vg(a,c,32,8,1)+"  "+c+".":vg(a,c,32,16,1)+"  "+vg(a,c,32,8,1)+"  "+vg(a,c,32,2,8)+"  "+c+".";32<=c&&127>c&&(e+=" '"+String.fromCharCode(c)+"'")}a.i((null!=b?b+": ":"")+e);return d}function zg(a,b){var c=0;if(a.A){if(b)return xg(a,b,a.A[b]&&a.A[b].value);b=Object.keys(a.A);b.sort();for(var d=0;d<b.length;d++)xg(a,b[d],a.A[b[d]].value),c++}return 0<c}
function vg(a,b,c,d,e){c=void 0===c?0:c;e=void 0===e?0:e;switch((void 0===d?0:d)||a.u){case 2:(a=0<c?c:0)?36<a&&(a=36):(a=Math.abs(b),a=255>=a?8:262143>=a?18:36);b=wa(b,2,a,"",e);break;case 8:(a=0<c?(c+2)/3|0:0)?12<a&&(a=12):(a=Math.abs(b),a=262143>=a?6:16777215>=a?8:12);b=wa(b,8,a,e?"0o":"");break;case 10:(e=0<c?Math.ceil(.3*c):0)?11<e&&(e=11):e=99999>=Math.abs(b)?5:11;b=wa(b,10,e);break;default:b=n(b,0<c?c+3>>2:0,!!e)}0>c?c=b.replace(/^0+([0-9A-F]+)$/i,"$1"):c=b;return c}
var tg={"||":5,"\x26\x26":6,"!":7,"|":7,"^!":8,"\x26":9,"!\x3d":10,"\x3d\x3d":10,"\x3e\x3d":11,"\x3e":11,"\x3c\x3d":11,"\x3c":11,"\x3e\x3e\x3e":12,"\x3e\x3e":12,"\x3c\x3c":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},sg={",,":1,"||":5,"\x26\x26":6,"!\x3d":10,"\x3d\x3d":10,"\x3e\x3d":11,"\x3e":11,"\x3c\x3d":11,"\x3c":11,"\x3e\x3e\x3e":12,"\x3e\x3e":12,"\x3c\x3c":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"\x26":15,_:19,"^_":19,"{":20,"}":20};
function Ag(a){mg.call(this,a);this.style=Bg;this.J=Cg();this.qa=Cg();this.S=Cg();this.C=[];this.j=this.L=this.B=[];Dg(this);this.W=0;dh(this);this.ja={};fh(this,a.messages);this.la=a.commands;var b=this;window?void 0===window.pc8080&&(window.pc8080=function(a){return ad(b,a)}):void 0===global.pc8080&&(global.pc8080=function(a){return ad(b,a)})}ia(Ag,mg);l=Ag.prototype;
l.Da=function(a,b,c,d){this.H=b;this.w=c;this.P=a;(a=Xc(a,"messages"))&&fh(this,a);this.ma=gh;me(this,64,function(a){a:{var b=d.H.b,c=a[0],e=a=0,k=b.length;if(c){a=hh(ih(d,c));if(-1===a){d.i("invalid address: "+c);break a}e=a>>>d.H.g;k=1}d.i("blockid   physical   blockaddr   used    size    type");d.i("--------  ---------  ----------  ------  ------  ----");c=-1;for(var p=0;k--;){var v=b[e];v.type==c?p++||d.i("..."):(c=v.type,p=fc[c],v&&d.i(n(v.id)+"  %"+n(e<<d.H.g)+"  %%"+n(v.K)+"  "+q(v.lb)+"  "+
q(v.size)+"  "+p),c!=Jc&&(c=-1),p=0);a+=d.H.u;e++}}});Nb(this)};
l.ca=function(a,b,c){var d=this;switch(b){case "debugInput":return this.U=this.O[b]=c,c.onkeydown=function(a){if(13==a.keyCode){var b=c.value;c.value="";ad(d,b,!0)}else if(27==a.keyCode)c.value=b="";else if(38==a.keyCode?(b=null,d.b<d.g.length-1&&(b=d.g[++d.b])):40==a.keyCode&&(0<d.b?b=d.g[--d.b]:(b="",d.b=-1)),null!=b){var e=b.length;c.value=b;c.setSelectionRange(e,e)}null!=b&&a.preventDefault&&a.preventDefault()},!0;case "debugEnter":return this.O[b]=c,cb(c,function(){if(d.U){var a=d.U.value;d.U.value=
"";ad(d,a,!0);return!0}return!1}),!0;case "step":return this.O[b]=c,cb(c,function(a){var b=!1;Ob(d,!0)||(Pb(d,!0),b=jh(d,a?1:0),Pb(d,!1));return b}),!0}return!1};l.Va=function(){this.U&&this.U.focus()};function hh(a){a=a&&a.K;null==a&&(a=-1);return a}l.Ea=function(a,b){var c=255,d=hh(a);-1!==d&&(c=hc(this.H,d),b&&kh(a,b));return c};l.Db=function(a,b){var c=65535,d=hh(a);-1!==d&&(c=jc(this.H,d),b&&kh(a,b));return c};l.Wb=function(a,b,c){var d=hh(a);-1!==d&&(kc(this.H,d,b),c&&kh(a,c),bd(this.w,!0))};
l.Oc=function(a,b,c){var d=hh(a);if(-1!==d){var e=this.H,f=d&e.j,g=(d&e.C)>>>e.g;f!=e.j?e.b[g].Rb(f,b&65535,d):(e.b[g++].mb(f,b&255,d),e.b[g&e.G].mb(0,b>>8&255,d+1));c&&kh(a,c);bd(this.w,!0)}};function Cg(a){return{K:a,Aa:!1}}function lh(a){return{K:a[0],Aa:a[1]}}
function ih(a,b,c){c=(c?a.J:a.qa).K;if(void 0!==b){var d=b=yg(a,b)||b;var e;if(d.match(/^[a-z_][a-z0-9_]*$/i))for(d=d.toUpperCase(),c=0;c<a.C.length;c++){var f=a.C[c].pa[d];if(void 0!==f){d=f.o;void 0!==d&&(e=Cg(d));break}}if(d=e)return d;c=wg(a,b)}null!=c&&(d=Cg(c));return d}function mh(a,b,c){c&&(c=c.match(/(['"])(.*?)\1/))&&(b.qd=a.xb(b.Hc=c[2]))}function kh(a,b){null!=a.K&&(a.K+=b||1)}function nh(a){return n(a.K,4)}
function oh(a,b,c){var d="";for(c=c||256;d.length<c;){var e=a.Ea(b,1);if(!e||36==e||127<=e)break;d+=32<=e?String.fromCharCode(e):"."}return d}function fh(a,b){a.I=a;a.fa=a.ud=1073741824;a.X=null;a.Y=[];b=a.xb(b.replace("keys","key").replace("kbd","keyboard"),!1,"|");if(b.length)for(var c in Xb)0<=Ma(b,c)&&(a.fa|=Xb[c],a.i(c+" messages enabled"))}function me(a,b,c){for(var d in Xb)if(b==Xb[d]){a.ja[d]=c;break}}
l.Ib=function(a,b){a=a.toUpperCase();if(null==b)var c=Ma(ph,a);else c=Ma(ph,a.substr(b,2)),0>c&&(c=Ma(ph,a.substr(b,1)));return c};function qh(a,b){var c=0;a=a.Jb(b);if(void 0!==a)switch(b){case rh:case sh:case th:case uh:case vh:case wh:case xh:case yh:c=2;break;case zh:case Ah:case Bh:case Ch:case Dh:case Eh:case Fh:c=4}return c?n(a,c):"??"}
l.Jb=function(a){if(0<=a){var b=this.w;switch(a){case rh:var c=b.g;break;case sh:c=b.u;break;case th:c=b.A;break;case zh:c=Hd(b);break;case uh:c=b.B;break;case vh:c=b.C;break;case Ah:c=Jd(b);break;case wh:c=b.D;break;case xh:c=b.F;break;case Bh:c=C(b);break;case yh:c=E(b,C(b));break;case Ch:c=b.L;break;case Dh:c=b.j;break;case Eh:c=Fd(b);break;case Fh:c=Fd(b)&255|b.g<<8}}return c};
function Gh(a,b){b=yg(a,b)||b;for(var c=0,d,e;0<=(c=b.indexOf("@",c));)e=a.Ib(b,c+1),0<=e&&(b=b.substr(0,c)+qh(a,e)+b.substr(c+1+ph[e].length)),c++;for(c=0;0<=(c=b.indexOf("#",c));)e=b.substr(c+1,2),d=ta(e,16),null!=d&&32<=d&&127>d?(d=e+" '"+String.fromCharCode(d)+"'",b=b.replace("#"+e,d),c+=d.length):c++;for(c=0;0<=(c=b.indexOf("$",c));)e=b.substr(c+1,9),(d=ih(a,e))?(d=e+' "'+oh(a,d)+'"',b=b.replace("$"+e,d),c+=d.length):c++;for(c=0;0<=(c=b.indexOf("^",c));)e=b.substr(c+1,9),(d=ih(a,e))?(kh(d),d=
e+' "'+oh(a,d,11)+'"',b=b.replace("^"+e,d),c+=d.length):c++;return b}l.message=function(a,b){b&&(a+=" at "+nh(Cg(this.w.j)));this.fa&536870912?this.Y.push(a):this.X&&a==this.X||(this.X=a,this.fa&-2147483648&&(Uc(this),a+=" (cpu halted)"),this.i(a),this.w&&(a=this.w,vd(a),a.ra=0,bd(a)))};
function Sb(a,b,c,d,e,f,g,h){h|=256;null!=f&&(a.fa&h)!=h||a.message(b.Fb+"."+(null!=d?"outPort":"inPort")+"("+q(c)+","+(f?f:"unknown")+(null!=d?","+xa(d):"")+")"+(null!=g?": "+xa(g):"")+(null!=e?" at "+n(e,4):""))}
function dh(a){var b;if(ee(a)){if(!a.G||!a.G.length){a.G=Array(Hh);for(b=0;b<a.G.length;b++)a.G[b]=Cg();a.V=0;a.i("instruction history buffer allocated")}if(!a.D||!a.D.length)for(a.D=Array(256),b=0;b<a.D.length;b++)a.D[b]=[b,0]}else a.G&&a.G.length&&a.i("instruction history buffer freed"),a.V=0,a.G=[],a.D=[]}function Ih(a,b){if(!Jh(a))return!1;a.w.pb(b);return!0}
function jh(a,b,c,d){if(!Jh(a))return!1;a.F=0;b||ee(a)&&fe(a,a.w.j,0);try{var e=a.w.Bb(b);0<e&&(a.F+=e,qd(a.w,e,!0),cd(a.w,e),a.R++)}catch(f){"number"!=typeof f&&(b=f,a.F=0,Lb(a.w,b.stack||b.message))}!1!==d&&bd(a.w);$c(a,c||!1);return 0<a.F}function Uc(a,b){a.w&&ed(a.w,b)}function $c(a,b){void 0===b&&(b=!0);a.J=Cg(a.w.j);b&&1!=a.N?Kh(a):Lh(a)}
function Jh(a){var b;if(b=a.w&&Mb(a.w))b=a.w,b.flags.ha?b=!0:(b.i(b.toString()+" not powered"),b=!1);b&&!Ob(a.w)?(a=a.w,a.flags.error?(a.i(a.toString()+" error"),a=!0):a=!1,a=!a):a=!1;return a}l.ta=function(a,b){return!b&&(this.reset(!0),a&&this.restore&&!this.restore(a))?!1:!0};l.sa=function(a,b){b&&this.i(a?"suspending":"shutting down");return a?this.save():!0};l.reset=function(a){dh(this);this.R=this.aa=0;this.X=null;this.F=0;this.J=Cg(this.w.j);this.flags.ia=!1;Mh(this);a||$c(this)};
l.save=function(){var a=new Gd(this),b=this.J;a.set(0,[b.K,b.Aa]);b=this.S;a.set(1,[b.K,b.Aa]);a.set(2,[this.g,this.M,this.fa]);a.set(3,this.C);return a.data()};l.restore=function(a){var b=0;void 0!==a[2]&&(this.J=lh(a[b++]),this.S=lh(a[b++]),this.g=a[b][0],"string"==typeof this.g&&(this.g=[this.g]),this.M=a[b][1],this.fa|=a[b][2]);a[3]&&(this.C=a[3]);return!0};l.start=function(a,b){this.N||this.i("running");this.flags.ia=!0;this.wa=a;this.xa=b};
l.stop=function(a,b){if(this.flags.ia){this.flags.ia=!1;this.F=b-this.xa;if(!this.N){b="stopped";if(this.F){a-=this.wa;var c=0<a?Math.round(1E3*this.F/a):0;b+=" (";ee(this)&&(b+=this.R+" opcodes, ",this.aa-=this.R,this.R=0);b+=this.F+" cycles, "+a+" ms, "+c+" hz)"}else Qb(this,-2147483648)&&(b+=" (use the 't' command to execute blocked faults)");this.i(b)}$c(this,!0);this.Va();Mh(this,this.w.j)}};function ee(a){return 1<a.j.length||!!a.W}
function fe(a,b,c){var d=a.w;if(0<c&&(a.W&&!--a.W||Tc(a,b,1,a.j)))return!0;0<=c&&a.D.length&&(a.R++,b=hc(a.H,b),null!=b&&(a.D[b][1]++,b=a.G[a.V],b.K=d.j,b.Aa=!1,++a.V==a.G.length&&(a.V=0)));return!1}function Ac(a,b,c){a.i("break on input from port "+q(b)+": "+n(c));Uc(a,!0)}function Ec(a,b,c){a.i("break on output to port "+q(b)+": "+n(c));Uc(a,!0)}
function Dg(a){var b;a.j=["bp"];if(void 0!==a.L)for(b=1;b<a.L.length;b++){var c=a.L[b];mc(a.H,hh(c),!1)}a.L=["br"];if(void 0!==a.B)for(b=1;b<a.B.length;b++)c=a.B[b],mc(a.H,hh(c),!0);a.B=["bw"];a.ra=0}l.Ma=function(a,b,c){var d=!0;c||Nh(this,a,b,!1,!0);if(a!=this.j){var e=hh(b);if(-1===e)this.i("invalid address: "+nh(b)),d=!1;else{var f=this.H;f.b[e>>>f.g].Ma(e&f.j,a==this.B)}}d&&(a.push(b),c?b.Aa=!0:(Oh(this,a,a.length-1,"set"),dh(this)))};
function Nh(a,b,c,d,e){var f=!1;c=hh(c);for(var g=1;g<b.length;g++){var h=b[g];if(c==hh(h)&&(!d||h.Aa)){f=!0;h.Aa||e||Oh(a,b,g,"cleared");b.splice(g,1);b!=a.j&&mc(a.H,c,b==a.B);h.Aa||dh(a);break}}return f}function Ph(a,b){for(var c=1;c<b.length;c++)Oh(a,b,c);return b.length-1}function Oh(a,b,c,d){c=b[c];a.i(b[0]+" "+nh(c)+(d?" "+d:c.Hc?' "'+c.Hc+'"':""))}function Mh(a,b){if(void 0!==b)Tc(a,b,1,a.j,!0),a.N=0;else for(b=1;b<a.j.length;b++){var c=a.j[b];if(c.Aa){if(!Nh(a,a.j,c,!0))break;b=0}}}
function Tc(a,b,c,d,e){var f=!1;if(!a.ra++)for(var g=1;!f&&g<d.length;g++){var h=d[g];if(!e||h.Aa)for(var k=hh(h),p=0;p<c;p++)if(b+p==k){var v;f=!0;h.Aa&&(Nh(a,d,h,!0),e=!0);if(v=h.qd){f=!1;for(var x=0;x<v.length;x++)if(!Qh(a,v[x],!0)){if(v[x].indexOf("if")){f=!0;break}for(var z=x+1;z<v.length&&v[z].indexOf("else");z++)x++;if(z==v.length){f=!0;break}}a.w.flags.ia||(f=!0)}if(f){e||Oh(a,d,g,"hit");break}}}a.ra--;return f}
function Rh(a,b,c,d){for(var e=Cg(b.K),f=a.Ea(b,1),g=a.ma[f],h="",k=(a.style!=Sh?Th:Uh)[g[0]],p=g.length-1,v=Vh,x,z=1;z<=p;z++){var u="";x=g[z];if(void 0!==x&&!(x&N&&a.style==Bg)){var w=x&Wh;if(w){var D=x&Xh;D?v=D:x|=v;x&Yh||(x|=1==z?Zh:$h);if(w&O)a:{u=a;w=x;D=b;switch(w&Xh){case Q:D=n(u.Ea(D,1),2);break;case ai:D=n(u.Ea(D,1)<<24>>24,4);break;case bi:D=n(u.Db(D,2),4);break;default:u="imm("+q(w)+")";break a}u.style==Sh&&w&ci?D="["+D+"]":w&di||(D=(u.style==Bg?"$":"0x")+D);u=D}else w&di?(u=(x&ei)>>8,
w=ph[u],a.style==Sh&&x&ci&&(u==yh&&(w="HL"),w="["+w+"]"),u=w):w&fi&&(u=(f>>3&7).toString());if(!u||!u.length){h="INVALID";break}0<h.length&&(h+=",");h+=u||"???"}}}f="";g=nh(e)+" ";if(-1!==e.K&&-1!==b.K){do if(f+=n(a.Ea(e,1),2),null==e.K)break;while(e.K!=b.K)}g+=Fa(f,10);g+=x&gi?"*":" ";g+=Fa(k,7);h&&(g+=" "+h);c&&(g=Fa(g,40)+";"+c,g=a.w.flags.Ta?g+("cycles\x3d"+dd(a.w).toString()+" cs\x3d"+n(a.w.ua)):g+(null!=d?"\x3d"+d.toString():""));return g}
function hi(a,b){switch(b){case "IF":a=a.w.M&512;break;case "SF":a=Rd(a.w);break;case "ZF":a=Qd(a.w);break;case "AF":a=Pd(a.w);break;case "PF":a=Od(a.w);break;case "CF":a=Md(a.w);break;default:a=0}return b.charAt(0)+(a?"1":"0")+" "}function ii(a,b){return ph[b]+"\x3d"+qh(a,b)+" "}function ji(a){return ii(a,rh)+ii(a,zh)+ii(a,Ah)+ii(a,Bh)+ii(a,Ch)+hi(a,"IF")+hi(a,"SF")+hi(a,"ZF")+hi(a,"AF")+hi(a,"PF")+hi(a,"CF")}l.yc=function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0};
function ki(a,b,c){var d=[],e=hh(b)>>>0;for(b=0;b<a.C.length;b++){var f=a.C[b],g=f.K>>>0,h=f.Od;if(e>=g&&e<g+h){e=Ia(f.xc,[e-g],a.yc);0<=e?li(a,b,e,d):c&&(e=~e,li(a,b,e-1,d),li(a,b,e,d));break}}return d}function li(a,b,c,d){var e={},f=a.C[b].xc,g=0,h=null;0<=c&&c<f.length&&(g=f[c][0],h=f[c][1]);h&&(e=a.C[b].pa[h],h="."==h.charAt(0)?null:e.l||h);d.push(h);d.push(g);d.push(e.a);d.push(e.c)}
function mi(a,b){if("?"==b)a.i("frequency commands:"),a.i("\tclear\tclear all frequency counts");else{var c=0;if(a.D)if("clear"==b){for(b=0;b<a.D.length;b++)a.D[b]=[b,0];a.i("frequency data cleared");c++}else if(void 0!==b)a.i("unknown frequency command: "+b),c++;else{var d=a.D.slice();d.sort(function(a,b){return b[1]-a[1]});var e=a.style!=Sh?Th:Uh;for(b=0;b<d.length;b++){var f=d[b][0],g=d[b][1];g&&(a.i((e[a.ma[f][0]]+"  ").substr(0,5)+" ("+xa(f)+"): "+g+" times"),c++)}}c||a.i("no frequency data available")}}
function ni(a,b){var c=b.match(/^\s*([A-Z_]?[A-Z0-9_]*)\s*(=?)\s*(.*)$/i);if(c){if(!c[1])return zg(a)||a.i("no variables"),!0;if(!c[2])return zg(a,c[1]);if(!c[3])return delete a.A[c[1]],!0;b=wg(a,c[3]);return void 0!==b?(a.A[c[1]]={value:b,ne:void 0},!0):!1}a.i("invalid assignment:"+b);return!1}
function oi(a,b,c){var d=null;if(b=ih(a,b,!0)){var e=ki(a,b,!0);if(e.length){var f;if(e[0]){var g="";(f=b.K-e[1])&&(g=" + "+q(f));f=e[0]+" ("+n(e[1],4)+")"+g;c&&a.i(f);d=f}4<e.length&&e[4]&&(g="",(f=e[5]-b.K)&&(g=" - "+q(f)),f=e[4]+" ("+n(e[5],4)+")"+g,c&&a.i(f),d||(d=f))}else c&&a.i("no symbols")}return d}
function pi(a,b){switch(b[1]){case "8080":a.style=Bg;break;case "8086":a.style=Sh;break;case "cs":var c;void 0!==b[3]&&(c=+b[3]);switch(b[2]){case "int":a.w.la=c;break;case "start":a.w.wa=c;break;case "stop":a.w.qa=c;break;default:a.i("unknown cs option");return}void 0!==c&&Zc(a.w);a.i("checksums "+(a.w.flags.Ta?"enabled":"disabled"));return;case "sp":void 0!==b[2]&&(pd(a.w,+b[2])||a.i("warning: using 1x multiplier, previous target not reached"));a.i("target speed: "+(a.w.Y.toFixed(2)+"Mhz")+" ("+
a.w.S+"x)");return;case "?":a.i("debugger options:");a.i("\t8080\t\tselect 8080-style mnemonics");a.i("\t8086\t\tselect 8086-style mnemonics");a.i("\tcs int #\tset checksum cycle interval to #");a.i("\tcs start #\tset checksum cycle start count to #");a.i("\tcs stop #\tset checksum cycle stop count to #");a.i("\tsp #\t\tset speed multiplier to #");break;default:if(b[1]){a.i("unknown option: "+b[1]);return}}a.i(a.style+"-style mnemonics enabled")}
function Kh(a,b){var c;if(b&&"?"==b[1])a.i("register commands:"),a.i("\tr\tdump registers"),a.i("\trx [#]\tset flag or register x to [#]");else{var d=a.w;null==c&&(c=!0);if(null!=b&&1<b.length){var e=b[1],f=e.indexOf("\x3d");if(0<f)b=e.substr(f+1),e=e.substr(0,f);else if(2<b.length)b=b[2];else{a.i("missing value for "+b[1]);return}f=wg(a,b);if(void 0===f)return;switch(e.toUpperCase()){case "A":d.g=f&255;break;case "B":d.u=f&255;break;case "BC":d.u=f>>8&255;case "C":d.A=f&255;break;case "D":d.B=f&
255;break;case "DE":d.B=f>>8&255;case "E":d.C=f&255;break;case "H":d.D=f&255;break;case "HL":d.D=f>>8&255;case "L":d.F=f&255;break;case "SP":d.L=f&65535;break;case "PC":B(d,f);a.J=Cg(d.j);break;case "PS":Dd(d,f);break;case "PSW":Dd(d,f&255|d.M&-256);d.g=f>>8;break;case "CF":d.G=f?d.G|256:d.G&255;break;case "PF":f?Od(d)||(d.J^=1):Od(d)&&(d.J^=1);break;case "AF":d.N=f?~d.J&16|d.N&-17:d.J&16|d.N&-17;break;case "ZF":d.G=f?d.G&-256:d.G|255;break;case "SF":f?Rd(d)||(d.J^=192):Rd(d)&&(d.J^=192);break;case "IF":d.M=
f?d.M|512:d.M&-513;break;default:a.i("unknown register: "+e);return}bd(d);a.i("updated registers:")}a.i(ji(a));c&&(a.J=Cg(d.j),Lh(a,nh(a.J)))}}function qi(a,b){b=Ga(b);var c=b.match(/^(['"])(.*?)\1$/);c?a.i(Gh(a,c[2])):wg(a,b,!1)}function ri(a,b,c){var d="t"!=b;c=qg(a,c,null,!0)||1;var e=1==c?0:1;"tc"==b&&(e=c,c=1);bb(c,function(){return Pb(a,!0)&&jh(a,e,d,!1)},function(){bd(a.w);Pb(a,!1)})}
function Lh(a,b,c,d){if(b=ih(a,b,!0)){void 0===d&&(d=1);var e=256;if(void 0!==c){d=ih(a,c,!0);if(!d||d.K<b.K)return;e=d.K-b.K;if(256<e){a.i("range too large");return}d=-1}c=0;for(var f;0<e&&d--;){f=Ob(a,!1)||a.N?a.F:null;var g=null!=f?"cycles":null,h=ki(a,b),k=b.K;if(h[0]&&d&&(!c&&d||0>h[0].indexOf("+"))){var p=h[0]+":";h[2]&&(p+=" "+h[2]);a.i(p)}h[3]&&(g=h[3],f=null);f=Rh(a,b,g,f);a.i(f);a.J=b;e-=b.K-k;c++}}}
l.xb=function(a,b,c){if(b)if(a){0>this.b&&this.g.length&&(this.b=0);if(0>this.b||a!=this.g[this.b])this.g.splice(0,0,a),this.b=0;this.b--}else this.M?a="end":a=this.g[this.b+1];b=[];if(a){a=a.toLowerCase().replace(/""/g,"'");var d=0,e=null;c=c||";";for(var f=0;f<=a.length;f++){var g=a.charAt(f);if('"'==g||"'"==g)e?g==e&&(e=null):e=g;else if(g==c&&!e||!g)b.push(Ga(a.substring(d,f))),d=f+1}}return b};
function Qh(a,b,c){var d=!0;try{b.length&&"end"!=b?c||a.i("\x3e\x3e "+b):(a.M&&(a.i("ended assemble at "+nh(a.S)),a.J=a.S,a.M=!1),b="");var e=b.charAt(0);if('"'==e||"'"==e)return!0;a.X=null;if(Mb(a)&&0<b.length){a.M&&(b="a "+nh(a.S)+" "+b);var f=b.replace(/ +/g," ").split(" ");if(f&&f.length)for(var g=f[0],h=g.charAt(0),k=1;k<g.length;k++){var p=g.charAt(k);if("?"==h||"r"==h||"a">p||"z"<p){f[0]=g.substr(k);f.unshift(g.substr(0,k));break}}switch(f[0].charAt(0)){case "a":var v=ih(a,f[1],!0);if(v)if(a.S=
v,void 0===f[2])a.i("begin assemble at "+nh(v)),a.M=!0,bd(a.w);else{a.i("not supported yet");var x=[];if(x.length){for(var z=0;z<x.length;z++)a.Wb(v,x[z],1);a.i(Rh(a,a.S))}}break;case "b":a:{var u=f[0],w=f[1],D=b;if("?"==w)a.i("breakpoint commands:"),a.i("\tbi [p]\ttoggle break on input port [p]"),a.i("\tbo [p]\ttoggle break on output port [p]"),a.i("\tbp [a]\tset exec breakpoint at addr [a]"),a.i("\tbr [a]\tset read breakpoint at addr [a]"),a.i("\tbw [a]\tset write breakpoint at addr [a]"),a.i("\tbc [a]\tclear breakpoint at addr [a]"),
a.i("\tbl\tlist all breakpoints"),a.i("\tbn [n]\tbreak after [n] instruction(s)");else{var T=u.charAt(1);if("l"==T){var Na=0+Ph(a,a.j);Na+=Ph(a,a.L);(Na+=Ph(a,a.B))||a.i("no breakpoints")}else if("n"==T)a.W=qg(a,w),a.i("break after "+a.W+" instruction(s)");else if(void 0===w)a.i("missing breakpoint address");else{var P=Cg();if("*"!=w&&(P=ih(a,w,!0),!P))break a;w=q(P.K);"c"==T?null==P.K?(Dg(a),a.i("all breakpoints cleared")):Nh(a,a.j,P)||Nh(a,a.L,P)||Nh(a,a.B,P)||a.i("breakpoint missing: "+nh(P)):
"i"==T?a.i("breakpoint "+(oc(a.H,P.K)?"enabled":"cleared")+": port "+w+" (input)"):"o"==T?a.i("breakpoint "+(Bc(a.H,P.K)?"enabled":"cleared")+": port "+w+" (output)"):null!=P.K&&(mh(a,P,D),"p"==T?a.Ma(a.j,P):"r"==T?a.Ma(a.L,P):"w"==T?a.Ma(a.B,P):a.i("unknown breakpoint command: "+T))}}}break;case "c":var ob=a.P;ob.B&&(ob.B.value="");break;case "d":a:{var Oa,ua=f[0],ma=f[1],va=f[2],Ti=f[3];if("?"==ma){var Vb="";for(Oa in Xb)a.ja[Oa]&&(Vb&&(Vb+=","),Vb+=Oa);Vb+=",state,symbols";a.i("dump memory commands:");
a.i("\tdb [a] [#]    dump # bytes at address a");a.i("\tdw [a] [#]    dump # words at address a");a.i("\tdd [a] [#]    dump # dwords at address a");a.i("\tdh [#] [#]    dump # instructions from history");Vb.length&&a.i("dump extension commands:\n\t"+Vb)}else if("state"==ma){var te=si(a.P,!0);if("console"==va)console.log(te);else{var Eg=a.P;Eg.B&&(Eg.B.value="");te&&a.i(te)}}else if("symbols"==ma)for(var ue=0;ue<a.C.length;ue++){var ve=a.C[ue],Wb;for(Wb in ve.pa)if("."!=Wb.charAt(0)){var Fg=ve.pa[Wb].o;
if(void 0!==Fg){var Gg=ve.pa[Wb].l;Gg&&(Wb=Gg);a.i(n(Fg,4)+" "+Wb)}}}else{if("d"==ua){for(Oa in Xb)if(f[1]==Oa){var Hg=a.ja[Oa];Hg?(f.shift(),f.shift(),Hg(f)):a.i("no dump registered for "+ma);break a}ma||(ua=a.Ba||"db")}else a.Ba=ua;if("dh"==ua){var Ig=ma,Jg=va,Kg="",Lg=0,Pa=a.V,db=a.G;if(db.length){var Ba=+Ig||a.ua,qc=+Jg||10;isNaN(Ba)?Ba=qc:Kg="more ";Ba>db.length&&(a.i("note: only "+db.length+" available"),Ba=db.length);Pa-=Ba;0>Pa&&(null==db[db.length-1].K?(Ba=Pa+Ba,Pa=0):Pa+=db.length);var we=
[];"call"==Jg&&(qc=1E5,we=["CALL"]);for(void 0!==Ig&&a.i(Ba+" instructions earlier:");0<qc&&Pa!=a.V;){var Mg=db[Pa++];if(null==Mg.K)break;var rc=Cg(Mg.K),Ui=Ba--,Ng=Rh(a,rc,"history",Ui);(!we.length||0<=Ng.indexOf(we[0]))&&a.i(Ng);rc.Hb&&(Pa+=rc.Hb,qc-=rc.Hb,Ba-=rc.Hb);Pa>=db.length&&(Pa=0);a.ua=Ba;Lg++;qc--}}Lg||(a.i("no "+Kg+"history available"),a.ua=void 0)}else{var fd=ih(a,ma);if(fd){var gd=0;va&&("l"==va.charAt(0)&&(va=va.substr(1)||Ti),gd=qg(a,va)>>>0,65536<gd&&(gd=65536));for(var sc="",hd=
"dd"==ua?4:"dw"==ua?2:1,id=hd*gd||128,Vi=id+15>>4||1;Vi--&&0<id;){var xe=0,ye=0,tc,ze="",Og="";ma=nh(fd);for(tc=16;0<tc&&0<id;tc--){var jd=a.Ea(fd,1);xe|=jd<<(ye++<<3);ye==hd&&(ze+=n(xe,2*hd),ze+=1==hd?9==tc?"-":" ":"  ",xe=ye=0);Og+=32<=jd&&127>jd?String.fromCharCode(jd):".";id--}sc&&(sc+="\n");sc+=ma+"  "+ze+(0==tc?" "+Og:"")}sc&&a.i(sc);a.qa=fd}}}}break;case "e":if("else"==f[0])break;var kd=1,Pg=255,Qg=a.Ea,Rg=a.Wb;"ew"==f[0]&&(kd=2,Pg=65535,Qg=a.Db,Rg=a.Oc);var Sg=kd<<1,Tg=f[1];if(null==Tg)a.i("edit memory commands:"),
a.i("\teb [a] [...]  edit bytes at address a"),a.i("\tew [a] [...]  edit words at address a");else{var ld=ih(a,Tg);if(ld)for(var md=2;md<f.length;md++){var uc=wg(a,f[md]);if(void 0===uc){a.i("unrecognized value: "+f[md]);break}uc&~Pg&&a.i("warning: "+n(uc)+" exceeds "+kd+"-byte value");var Wi=Qg.call(a,ld);a.i("changing "+nh(ld)+" from "+n(Wi,Sg,!0)+" to "+n(uc,Sg,!0));Rg.call(a,ld,uc,kd)}}break;case "f":mi(a,f[1]);break;case "g":a:{var Ug=f[1],Xi=b;if(void 0!==Ug){var Ae=ih(a,Ug,!0);if(!Ae)break a;
mh(a,Ae,Xi);a.Ma(a.j,Ae,!0)}Ih(a,!0)||c||a.i("cpu busy or unavailable, run command ignored")}break;case "h":a:{if(a.flags.ia){var Vg="halting";Uc(a)}else{if(Ob(a,!0))break a;Vg="already halted"}c||a.i(Vg)}break;case "i":if("if"==f[0]){var vc=b.substr(2);vc=Ga(vc);if(wg(a,vc)){c||a.i("true: "+vc);var Wg=!0}else c||a.i("false: "+vc),Wg=!1;Wg||(d=!1);break}if("int"==f[0]){var Yi=f[1];if(a.w.M&512){var Be=wg(a,Yi);if(null==Be)var Ce=!1;else a.i("requesting interrupt level "+Be),de(a.w,Be),Ce=!0}else a.i("interrupts disabled (use rif\x3d1 to enable)"),
Ce=!1;Ce||(d=!1);break}var De=f[1];if(De&&"?"!=De){var Ee=qg(a,De);if(void 0!==Ee){var Zi=zc(a.H,Ee);a.i(q(Ee)+": "+xa(Zi))}}else a.i("input commands:"),a.i("\ti [p]\tread port [p]"),a.i("warning: port accesses can affect hardware state");break;case "k":var $i=f[0];if("?"==f[1])a.i("stack trace commands:"),a.i("\tk\tshow frame addresses"),a.i("\tks\tshow symbol information");else{var Fe=0,Xg=Cg(),wc=Cg(a.w.L);for(a.i("stack trace for "+nh(wc));10>Fe;){for(var Bb=null,aj=256;65536>wc.K>>>0;){Xg.K=
a.Db(wc,2);if(null==wc.K||!aj--)break;for(var bj=a,nd=Xg,Yg=null,xc=nd.K,Zg=xc,Ge=1;6>=Ge&&xc;Ge++){if(2<Ge){nd.K=xc;var od=Rh(bj,nd);if(0<=od.indexOf("CALL")){var $g=od.indexOf(" ");if(xc+(od.indexOf(" ",$g+1)-$g-1)/2==Zg){Yg=od;break}}}xc--}nd.K=Zg;if(Bb=Yg)break}if(!Bb||null==Bb)break;var ah=null;if("ks"==$i){var bh=Bb.match(/[0-9A-F]+$/);bh&&(ah=oi(a,bh[0]))}Bb=Fa(Bb,50)+"  ;"+(ah||"stack\x3d"+nh(wc));a.i(Bb);Fe++}Fe||a.i("no return addresses found")}break;case "l":"ln"==f[0]&&oi(a,f[1],!0);break;
case "m":a:{var eb,fb=null,ba=f[1];"?"==ba&&(ba=void 0);if(void 0!==ba){var rb=0;if("all"==ba)rb=1610481663,ba=null;else if("on"==ba)fb=!0,ba=null;else if("off"==ba)fb=!1,ba=null;else{"keys"==ba&&(ba="key");"kbd"==ba&&(ba="keyboard");for(eb in Xb)if(ba==eb){rb=Xb[eb];fb=!!(a.fa&rb);break}if(!rb){a.i("unknown message category: "+ba);break a}}if(rb)if("on"==f[2])a.fa|=rb,fb=!0;else if("off"==f[2]&&(a.fa&=~rb,fb=!1,536870912==rb)){for(var He=0;He<a.Y.length;He++)a.i(a.Y[He]);a.Y=[]}}var cj=0,yc="";for(eb in Xb)if(!ba||
ba==eb){var dj=!!(a.fa&Xb[eb]);if(null===fb||fb==dj)yc&&(yc+=","),++cj%10||(yc+="\n\t"),"key"==eb&&(eb="keys"),yc+=eb}void 0===ba&&a.i("message commands:\n\tm [category] [on|off]\tturn categories on/off");a.i((null!==fb?fb?"messages on:  ":"messages off: ":"message categories:\n\t")+(yc||"none"));dh(a)}break;case "o":var Ie=f[1],ej=f[2];if(Ie&&"?"!=Ie){var Je=qg(a,Ie,"port #"),Ke=qg(a,ej);void 0!==Je&&void 0!==Ke&&(Dc(a.H,Je,Ke),a.i(q(Je)+": "+xa(Ke)))}else a.i("output commands:"),a.i("\to [p] [b]\twrite byte [b] to port [p]"),
a.i("warning: port accesses can affect hardware state");break;case "p":if("print"==f[0]){qi(a,b.substr(5));break}var ch="pr"==f[0]?1:0,fj=1+ch;if(a.N)a.i("step in progress");else{var Le=Cg(a.w.j);switch(a.Ea(Le)){case 205:a.N=fj,kh(Le,3)}a.N?(a.Ma(a.j,Le,!0),Ih(a)||(a.P&&a.P.Va(),a.N=0)):ri(a,ch?"tr":"t")}break;case "r":if("reset"==b){a.P&&a.P.reset();break}Kh(a,f);break;case "s":pi(a,f);break;case "t":ri(a,f[0],f[1]);break;case "u":Lh(a,f[1],f[2],8);break;case "v":if("var"==f[0]){ni(a,b.substr(3))||
(d=!1);break}a.i("PC8080 version 1.50.0 ("+a.w.tb+",RELEASE"+(Tb?",TYPEDARRAYS":",LONGARRAYS")+")");a.i(Sa());break;case "?":if(f[1]){qi(a,b.substr(1));break}var Me="commands:",Ne;for(Ne in ti)Me+="\n"+Fa(Ne,9)+ti[Ne];ee(a)||(Me+="\nnote: frequency/history disabled if no exec breakpoints");a.i(Me);break;default:a.i("unknown command: "+b),d=!1}}}catch(eh){a.i("debugger error: "+(eh.stack||eh.message)),d=!1}return d}function ad(a,b,c){b=a.xb(b,c);for(var d in b)if(!Qh(a,b[+d]))return!1;return!0}
var ti={"?":"help/print","a [#]":"assemble","b [#]":"breakpoint",c:"clear output","d [#]":"dump memory","e [#]":"edit memory",f:"frequencies","g [#]":"go [to #]",h:"halt","i [#]":"input port #","if":"eval expression","int [#]":"request interrupt",k:"stack trace",ln:"list nearest symbol(s)",m:"messages","o [#]":"output port #",p:"step over",print:"print expression",r:"dump/set registers",reset:"reset machine",s:"set options","t [#]":"trace","u [#]":"unassemble",v:"print version","var":"assign variable"},
Bg=8080,Sh=8086,Th="NONE ACI ADC ADD ADI ANA ANI CALL CC CM CNC CNZ CP CPE CPO CZ CMA CMC CMP CPI DAA DAD DCR DCX DI EI HLT IN INR INX JMP JC JM JNC JNZ JP JPE JPO JZ LDA LDAX LHLD LXI MOV MVI NOP ORA ORI OUT PCHL POP PUSH RAL RAR RET RC RM RNC RNZ RP RPE RPO RZ RLC RRC RST SBB SBI SHLD SPHL STA STAX STC SUB SUI XCHG XRA XRI XTHL".split(" "),Uh="NONE ADC ADC ADD ADD AND AND CALL CALLC CALLS CALLNC CALLNZ CALLNS CALLP CALLNP CALLZ NOT CMC CMP CMP DAA ADD DEC DEC CLI STI HLT IN INC INC JMP JC JS JNC JNZ JNS JP JNP JZ MOV MOV MOV MOV MOV MOV NOP OR OR OUT JMP POP PUSH RCL RCR RET RETC RETS RETNC RETNZ RETNS RETP RETNP RETZ ROL ROR RST SBB SBB MOV MOV MOV MOV STC SUB SUB XCHG XOR XOR XCHG".split(" "),
sh=0,th=1,uh=2,vh=3,wh=4,xh=5,yh=6,rh=7,zh=8,Ah=9,Bh=10,Ch=11,Dh=12,Eh=13,Fh=14,ph="B C D E H L M A BC DE HL SP PC PS PSW".split(" "),Xh=15,Wh=240,ei=3840,Yh=61440,Vh=0,Q=1,ai=2,bi=3,di=16,O=32,ci=64,fi=128,R=rh<<8|di|Q,S=sh<<8|di|Q,U=th<<8|di|Q,V=uh<<8|di|Q,W=vh<<8|di|Q,X=wh<<8|di|Q,Y=xh<<8|di|Q,Z=yh<<8|di|Q|ci,ui=zh<<8|di|bi,vi=Ah<<8|di|bi,wi=Bh<<8|di|bi,xi=Ch<<8|di|bi,yi=Fh<<8|di|bi,$h=4096,Zh=8192,N=16384,gi=32768,gh=[[45],[42,ui,O],[71,ui|ci,R|N],[29,ui],[28,S],[22,S],[44,S,O],[63],[45,gi],[21,
wi|N,ui],[40,R|N,ui|ci],[23,ui],[28,U],[22,U],[44,U,O],[64],[45,gi],[42,vi,O],[71,vi|ci,R|N],[29,vi],[28,V],[22,V],[44,V,O],[52],[45,gi],[21,wi|N,vi],[40,R|N,vi|ci],[23,vi],[28,W],[22,W],[44,W,O],[53],[45,gi],[42,wi,O],[68,51|ci,wi|N],[29,wi],[28,X],[22,X],[44,X,O],[20],[45,gi],[21,wi|N,wi],[41,wi|N,51|ci],[23,wi],[28,Y],[22,Y],[44,Y,O],[16,R|N],[45,gi],[42,xi,O],[70,51|ci,R|N],[29,xi],[28,Z],[22,Z],[44,Z,O],[72],[45,gi],[21,wi|N,xi],[39,R|N,51|ci],[23,xi],[28,R],[22,R],[44,R,O],[17],[43,S,S],[43,
S,U],[43,S,V],[43,S,W],[43,S,X],[43,S,Y],[43,S,Z],[43,S,R],[43,U,S],[43,U,U],[43,U,V],[43,U,W],[43,U,X],[43,U,Y],[43,U,Z],[43,U,R],[43,V,S],[43,V,U],[43,V,V],[43,V,W],[43,V,X],[43,V,Y],[43,V,Z],[43,V,R],[43,W,S],[43,W,U],[43,W,V],[43,W,W],[43,W,X],[43,W,Y],[43,W,Z],[43,W,R],[43,X,S],[43,X,U],[43,X,V],[43,X,W],[43,X,X],[43,X,Y],[43,X,Z],[43,X,R],[43,Y,S],[43,Y,U],[43,Y,V],[43,Y,W],[43,Y,X],[43,Y,Y],[43,Y,Z],[43,Y,R],[43,Z,S],[43,Z,U],[43,Z,V],[43,Z,W],[43,Z,X],[43,Z,Y],[26],[43,Z,R],[43,R,S],[43,R,
U],[43,R,V],[43,R,W],[43,R,X],[43,R,Y],[43,R,Z],[43,R,R],[3,R|N,S],[3,R|N,U],[3,R|N,V],[3,R|N,W],[3,R|N,X],[3,R|N,Y],[3,R|N,Z],[3,R|N,R],[2,R|N,S],[2,R|N,U],[2,R|N,V],[2,R|N,W],[2,R|N,X],[2,R|N,Y],[2,R|N,Z],[2,R|N,R],[73,R|N,S],[73,R|N,U],[73,R|N,V],[73,R|N,W],[73,R|N,X],[73,R|N,Y],[73,R|N,Z],[73,R|N,R],[66,R|N,S],[66,R|N,U],[66,R|N,V],[66,R|N,W],[66,R|N,X],[66,R|N,Y],[66,R|N,Z],[66,R|N,R],[5,R|N,S],[5,R|N,U],[5,R|N,V],[5,R|N,W],[5,R|N,X],[5,R|N,Y],[5,R|N,Z],[5,R|N,R],[76,R|N,S],[76,R|N,U],[76,R|
N,V],[76,R|N,W],[76,R|N,X],[76,R|N,Y],[76,R|N,Z],[76,R|N,R],[46,R|N,S],[46,R|N,U],[46,R|N,V],[46,R|N,W],[46,R|N,X],[46,R|N,Y],[46,R|N,Z],[46,R|N,R],[18,R|N,S],[18,R|N,U],[18,R|N,V],[18,R|N,W],[18,R|N,X],[18,R|N,Y],[18,R|N,Z],[18,R|N,R],[58],[50,ui],[34,51],[30,51],[11,51],[51,ui],[4,R|N,O|Q],[65,fi],[62],[54],[38,51],[30,51|gi],[15,51],[7,51],[1,R|N,O|Q],[65,fi],[57],[50,vi],[33,51],[48,O|Q,R|N],[10,51],[51,vi],[74,R|N,O|Q],[65,fi],[55],[54,gi],[31,51],[27,R|N,O|Q],[8,51],[7,51|gi],[67,R|N,O|Q],[65,
fi],[61],[50,wi],[37,51],[78,xi|ci|N,wi|N],[14,51],[51,wi],[6,R|N,O|Q],[65,fi],[60],[49,wi],[36,51],[75,wi|N,vi|N],[13,51],[7,51|gi],[77,R|N,O|Q],[65,fi],[59],[50,yi],[35,51],[24],[12,51],[51,yi],[47,R|N,O|Q],[65,fi],[56],[69,xi|N,wi|N],[32,51],[25],[9,51],[7,51|gi],[19,R|N,O|Q],[65,fi]],Hh=1E3;hb(function(){for(var a=zb(document,"pc8080","debugger"),b=0;b<a.length;b++){var c=a[b],d=Ab(c);d=new Ag(d);yb(d,c)}});
function zi(a,b,c){t.call(this,"Computer",a,67108864);this.flags.ha=!1;Ai(this,b);this.L=Xc(this,"autoPower",a);this.j=0;this.T=a.busWidth||a.buswidth;this.b=Bi;this.G=null;this.D=this.R=!1;this.V=Xc(this,"url")||"";(Math.random()+.1).toString(36);this.g=Ci(this);if(this.w=Eb("CPU",this.id)){this.I=Eb("Debugger",this.id);this.A=[];for(b=null;b=Zb(this,"Video",b);)this.A.push(b);this.H=new ac({id:this.Za+".bus",busWidth:this.T},this.w,this.I);var d=Cb(this.id);if(this.B=(this.C=Eb("Panel",this.id))&&
this.C.O.print)for(b=0;b<d.length;b++){var e=d[b];e.Z=this.C.Z;e.print=this.C.print;e.i=this.C.i}this.i("PC8080 v1.50.0\nCopyright \u00a9 2012-2018 Jeff Parsons \x3cJeff@pcjs.org\x3e\nLicense: GPL version 3 or later \x3chttp://gnu.org/licenses/gpl.html\x3e");for(b=0;b<d.length;b++)e=d[b],e.Da&&e.Da(this,this.H,this.w,this.I);b=null;e=Xc(this,"resume",a);void 0!==e&&(1<e.length?b=this.F=e:this.b=parseInt(e,10));var f;if(a=Xc(this,"state")||(f=!0,a.state))b=this.M=a,f||(this.D=!0,this.b=Bi),this.b&&
(this.J=new Gd(this,"1.50.0"),this.J.load()?b=null:delete this.J);!b&&this.b&&(b=Di(this))&&(this.D=!0);if(b){var g=this;Qa(b,null,!0,function(a,b,c){c?(g.F=null,g.D=!1,g.Z("Unable to load machine state from server (error "+c+(b?": "+Ga(b):"")+")")):(g.G=b,g.R=!0);Nb(g)})}else Nb(this);this.O.power||(this.L=!0);!c&&this.L&&this.wait(this.jb)}else r("Unable to find CPU component")}ia(zi,t);
function Ai(a,b){if(!b){var c;if("object"==typeof resources&&(c=resources.parms))try{b=eval("("+c+")")}catch(d){r(d.message+" ("+c+")")}}a.S=b}function Xc(a,b,c){var d=b.toLowerCase();d=$a(b)||$a(d);void 0===d&&a.S&&(d=a.S[b]);void 0===d&&c&&(d=c[b]);void 0===d&&"object"==typeof resources&&resources[b]&&(d=b);return d}l=zi.prototype;l.wait=function(a,b){for(var c=this,d=Cb(this.id),e=0;e<=d.length;e++){var f=e<d.length?d[e]:this;if(!Mb(f)){Mb(f,function(){c.wait(a,b)});return}}a.call(this,b)};
function Ei(a,b){var c=new Gd(a,"1.50.0",Fi);if(c.load()&&Gi(c)){var d=c.get(Hi),e=b?b.get(Hi):"unknown";d!=e&&(a.Z("Machine state may be out-of-date\n("+d+" vs. "+e+")\nCheck your browser's local storage limits"),b||c.clear())}}
l.jb=function(a){void 0===a&&(a=this.b||(this.G?Ii:Bi));if(!this.j){this.j++;var b=!1,c=!1;this.N=!1;var d=this.J||new Gd(this,"1.50.0");if(a==Ji)b=!0;else if(a>Bi){if(d.load(this.G)){this.u=new Gd(this,"1.50.0",Ki);this.u.load()&&(Li(this,d),a=Mi,Ni(this.u));this.u.set(Hi,Ja());this.u.store();var e=this.b&&!this.D;if(a==Ii||wb("Click OK to restore the previous PC8080 machine state, or CANCEL to reset the machine.")){if(c=Gi(d)){var f=d.get("code"),g=d.get("data");f&&("ok"==f?d.load(g):("error"==
f&&"no machine state"!=g?(this.Z("Error: "+g),"unable to verify user"==g&&(Wa(Oi,""),this.g=null)):this.i(f+": "+g),Ni(d),d.load()?(c=Gi(d),e=!0):c=!1))}e&&Ei(this,c?d:null)}else a==Mi&&d.clear()}else Ei(this);delete this.G;delete this.J}e=Cb(this.id);for(f=0;f<e.length;f++)g=e[f],g!==this&&g!=this.w&&(c=Pi(this,g,d,b,c));b=[d,a,c];a!=Ji?this.wait(this.Ac,b):this.Ac(b)}};
function Pi(a,b,c,d,e){if(!b.flags.ha){b.flags.ha=!0;if(b.ta){var f=null;e&&((f=c.get(b.id))||(f=c.get(b.id.replace(/-[0-9]+\./i,"."))));"string"===typeof f&&(f=null);!b.ta(f,d)&&f&&(r("Unable to restore state for "+b.type),a.M&&!a.R?(c.clear(),a.b=Bi,window&&window.location.reload()):a.N=!0,b.ta(null),e=!1)}if(!d&&b.uc)for(a=b.uc.split("|"),c=0;c<a.length;c++)b.status(a[c])}return e}
l.Ac=function(a){var b=a[0],c=0>a[1];a=a[2];this.U=!0;this.flags.ha=!0;var d=this.O.power;d&&(d.textContent="Shutdown");this.w&&(Pi(this,this.w,b,c,a),this.w.gb());this.N&&(Li(this,b),b.clear());!c&&this.u&&(this.u.clear(),delete this.u);this.j=0};
function Li(a,b){if(wb("There may be a problem with your PC8080 machine.\n\nTo help us diagnose it, click OK to send this PC8080 machine state to http://www.pcjs.org.")){var c=a.g||"";b=b.toString();var d={app:"PC8080",ver:"1.50.0"};d.url=a.V;d.user=c;d.type="bug";d.data=b;Qa("http://www.pcjs.org/api/v1/report",d,!0)}}
function si(a,b,c){var d="none";if(a.j)return null;a.j--;var e=new Gd(a,"1.50.0"),f=new Gd(a,"1.50.0",Fi),g=Ja();f.set(Hi,g);e.set(Hi,g);e.set(Qi,"1.50.0");e.set(Ri,window?window.location.href:null);e.set(Si,Sa());if(a.w&&a.w.sa){c&&ed(a.w);var h=a.w.sa(b,c);"object"===typeof h&&e.set(a.w.id,h);c&&(a.w.flags.ha=!1,!1===h&&(d=null))}g=Cb(a.id);for(var k=0;k<g.length;k++){var p=g[k];p.flags.ha&&(p.sa&&(h=p.sa(b,c),"object"===typeof h&&e.set(p.id,h)),c&&(p.flags.ha=!1,!1===h&&(d=null)))}d&&(c?(g=h=!1,
b?(a.g&&gj(a,a.g,e.toString()),f.store()&&e.store()||(d=null,h=g=!0)):a.b&&(h=!0,g=a.b==hj),h&&e.clear(g)):d=e.toString());c&&(a.flags.ha=!1,b=a.O.power)&&(b.textContent="Power");a.j=0;return d}l.reset=function(){this.H&&this.H.reset&&(Rb(this,"Resetting "+this.H.type),this.H.reset());for(var a=Cb(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.H&&c.reset&&(Rb(this,"Resetting "+c.type),c.reset())}};
l.start=function(a,b){for(var c=Cb(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.start&&e.start(a,b)}};l.stop=function(a,b){for(var c=Cb(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.stop&&e.stop(a,b)}};
l.ca=function(a,b,c){var d=this;switch(b){case "power":return this.O[b]=c,c.onclick=function(){d.j||(d.flags.ha?si(d,!1,!0):d.wait(d.jb))},!0;case "reset":return this.O[b]=c,c.onclick=function(){if(d.flags.ha&&!d.j)if(d.b&&!d.F){var a=wb("Click OK to save changes to this PC8080 machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");si(d,a,!0);!a&&d.M?window&&window.location.reload():d.jb(Bi)}else d.reset(),d.w&&d.w.gb()},!0;case "save":if(Aa())c.parentNode.removeChild(c);else return this.O[b]=
c,c.onclick=function(){var a=Ci(d,!0);if(a){var b=!!(d.b&&!d.F||d.M),c=si(d,b);b?gj(d,a,c):d.Z("Resume disabled, machine state not saved")}},!0}return!1};function Ci(a,b){var c=a.g;c||((c=Va(Oi),void 0!==c)?!c&&b&&(b=null,window&&(b=window.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c=b)&&((c=ij(a,c))||a.Z("The user ID is invalid.")):b&&a.Z("Browser local storage is not available"));return c}
function ij(a,b){a.g=null;b=Qa(Ca()+"/api/v1/user?req\x3dverify\x26user\x3d"+b);var c=b[1];if(!b[0]&&c)try{b=eval("("+c+")"),b.code&&"ok"==b.code&&(Wa(Oi,b.data),a.g=b.data)}catch(d){r(d.message+" ("+c+")")}return a.g}function Di(a){var b=null;a.g&&(b=Ca()+"/api/v1/user?req\x3dload\x26user\x3d"+a.g+"\x26state\x3d"+jj(a,"1.50.0"));return b}
function gj(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=jj(a,"1.50.0");d.data=c;b=Qa(Ca()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var e=d.indexOf("\n");0<e&&(d=d.substr(0,e));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&"ok"==b.code?a.Z("Machine state saved to server"):c&&(c=b&&b.data||"unable to save machine state",c="error"==b.code?"Error: "+c:"Error "+b.code+": "+c,a.Z(c),Wa(Oi,""),a.g=null)}}
function Zb(a,b,c){a=Cb(a.id);for(var d=0;d<a.length;d++){var e=a[d];if(c)c==e&&(c=null);else if(e.type==b)return e}return null}l.Va=function(a){if(this.A.length){var b=0,c=0;!a&&window&&(b=window.scrollX,c=window.scrollY);var d=this.A[0];d.U&&d.U.focus();!a&&window&&window.scrollTo(b,c)}};
function wd(a,b){a.w&&(a=a.w,a.cb&&(b||!a.flags.ia||a.flags.zc)&&(I(a,"A",a.g),I(a,"B",a.u),I(a,"C",a.A),I(a,"BC",Hd(a),4),I(a,"D",a.B),I(a,"E",a.C),I(a,"DE",Jd(a),4),I(a,"H",a.D),I(a,"L",a.F),I(a,"HL",C(a),4),I(a,"SP",a.L,4),I(a,"PC",a.j,4),b=Fd(a),I(a,"PS",b,4),I(a,"IF",b&512?1:0,1),I(a,"SF",b&128?1:0,1),I(a,"ZF",b&64?1:0,1),I(a,"AF",b&16?1:0,1),I(a,"PF",b&4?1:0,1),I(a,"CF",b&1?1:0,1)),b=a.O.speed)&&(b.textContent=a.flags.ia&&a.X?a.X.toFixed(2)+"Mhz":"Stopped")}
var Ki="failsafe",Fi="validate",Hi="timestamp",Qi="version",Ri="url",Si="browser",Oi="user",Ji=-1,Bi=0,Ii=1,Mi=2,hj=3;hb(function(){for(var a=zb(document,"pc8080-machine"),b=0;b<a.length;b++){var c=a[b],d=Ab(c);c=zb(c,"pc8080","computer");for(var e=0;e<c.length;e++){var f=c[e],g=Ab(f);g=new zi(g,d,!0);yb(g,f);g.L&&g.wait(g.jb)}}});ib.show.push(function(){for(var a=zb(document,"pc8080","computer"),b=0;b<a.length;b++){var c=Ab(a[b]);if(c=Eb("Computer",c.id))c.flags.Pb=!1,c.U&&!c.flags.ha&&c.jb(Ji)}});
ib.exit.push(function(){for(var a=zb(document,"pc8080","computer"),b=0;b<a.length;b++){var c=Ab(a[b]);if(c=Eb("Computer",c.id))c.flags.Pb=!0,c.flags.ha&&si(c,!(!c.b||c.F),!0)}});function Gd(a,b,c){this.id=a.id;this.I=a.I;this.g="";this.b={};this.w=this.H=!1;this.key=jj(a,b,c);Ni(this,a.yd)}l=Gd.prototype;l.set=function(a,b){try{this.b[a]=b}catch(c){}};l.get=function(a){return this.b[a]||null};l.data=function(){return this.b};
l.load=function(a){return a?(this.g=a,this.w=!0,this.H=!1,!0):this.w?!0:Ta()&&(a=Va(this.key))?(this.g=a,this.w=!0):!1};function Gi(a){var b=!0;if(!a.H)try{a.b=JSON.parse(a.g),a.H=!0}catch(c){r(c.message||c),b=!1}return b}l.store=function(){var a=!0;if(Ta()){var b=JSON.stringify(this.b);Wa(this.key,b)||(r("Unable to store "+b.length+" bytes in browser local storage"),a=!1)}return a};l.toString=function(){return this.b?JSON.stringify(this.b):this.g};
function Ni(a,b){a.g="";a.b={};a.w=a.H=!1;b&&a.set("parms",b)}l.clear=function(a){Ni(this);var b=[];try{for(var c=0,d=window.localStorage.length;c<d;c++)b.push(window.localStorage.key(c))}catch(e){}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){try{window.localStorage.removeItem(d)}catch(e){}b.splice(c,1);c=0}};function jj(a,b,c){a=a.id;if(b){var d=b.indexOf(".");0<d&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}var kj=0;
function lj(a,b,c,d,e,f){e("Loading "+a+"...");Qa(a,null,!0,function(g,h,k){k?(h||(h="unable to load "+a+" ("+k+")"),f(h,null)):mj(h,a,b,c,d,e,f)})}
function mj(a,b,c,d,e,f,g){function h(a,f){if(f)g(f,null);else{c&&(tb(c,b,a),(f=b)&&0>f.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(f=window.location.pathname+f),d?"}"==d.slice(-1)?(d=d.slice(0,-1),1<d.length&&(d+=",")):d='{state:"'+d+'",':d="{",d+='url:"'+f+'"}',"object"==typeof resources&&(f=null),d=d.replace(/\$/g,"$$$$"),a=a.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(d?" parms\x3d'"+d+"'":"")+(f?' url\x3d"'+f+'"':"")));e||(a=a.replace(/(<xsl:variable name="APPNAME">).*?(<\/xsl:variable>)/,
"$1PC8080$2"),a=a.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1pc8080$2"));f=null;if("\x3c"==a.charAt(0))try{e||(a=a.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(f=new window.ActiveXObject("Microsoft.XMLDOM"),f.async=!1,f.loadXML(a)):f=(new window.DOMParser).parseFromString(a,"text/xml")}catch(v){f=null,a=v.message}else a="unrecognized XML: "+(255<a.length?a.substr(0,255)+"...":a);g(a,f)}}a?e?nj(a,f,h):h(a,null):g("no data"+(b?" for file: "+
b:""),null)}
function nj(a,b,c){var d;if(d=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(a)){var e=d[2];b("Loading "+e+"...");Qa(e,null,!0,function(f,g,h){if(h||!g)c(a,"unable to resolve XML reference: "+d[0]+" ("+h+")");else{if(f=d[3])if(h=g.match(new RegExp("\x3c"+d[1]+"[^\x3e]*\x3e"))){for(var k=h[0],p,v=/( [a-z]+=)(['"])(.*?)\2/gi;p=v.exec(f);)k=0>k.toLowerCase().indexOf(p[1].toLowerCase())?k.replace("\x3e",p[0]+"\x3e"):k.replace(new RegExp(p[1]+"(['\"])(.*?)\\1"),p[0]);h[0]!=k&&(g=g.replace(h[0],k))}else{c(a,"missing \x3c"+
d[1]+"\x3e in "+e);return}g=g.replace(/<\?xml[^>]*>[\r\n]*/,"");a=a.replace(d[0],g);nj(a,b,c)}})}else c(a,null)}
function oj(a,b,c,d){function e(a){if(void 0===h){var b=g&&zb(g,"machine-warning");h=b&&b[0]||g}h&&(h.innerHTML=Da(a))}function f(a){e("Error: "+a);k&&(--kj||mb(!0));k=!1}var g,h,k=!0;b||(b="machine.xml",c||(c="components.xsl"));kj++;ub[a]={};try{if(g=document.getElementById(a)){var p;if("object"==typeof resources&&(p=resources.css)){var v=document.head||document.getElementsByTagName("head")[0],x=document.createElement("style");x.type="text/css";x.styleSheet?x.styleSheet.cssText=p:x.appendChild(document.createTextNode(p));
v.appendChild(x)}c||(c="/versions/pc8080/1.50.0/components.xsl");p=function(d,h){h?lj(c||"",null,null,!1,e,function(d,k){k?(tb(a,c||"",d),e("Processing "+b+"..."),window.ActiveXObject||"ActiveXObject"in window?(k=h.transformNode(k))?(g.outerHTML=k,--kj||mb(!0)):f("transformNodeToObject failed"):document.implementation&&document.implementation.createDocument?(d=new XSLTProcessor,d.importStylesheet(k),(k=d.transformToFragment(h,document))?g.parentNode?(g.parentNode.replaceChild(k,g),--kj||mb(!0)):f("invalid machine element: "+
a):f("transformToFragment failed")):f("unable to transform XML: unsupported browser")):f(d)}):f(d)};"\x3c"!=b.charAt(0)?lj(b,a,d,!0,e,p):mj(b,null,a,d,!1,e,p)}else f("missing machine element: "+a)}catch(z){f(z.message)}return k}window.embedPC8080=function(a,b,c,d){mb(!1);return oj(a,b,c,d)};
window.commandMachine=function(a,b,c,d,e,f){if("script"==e){d=!1;c+=".machine";if(!f)delete Gb[c],d=!0;else if("string"==typeof f&&!Gb[c]){d=!0;e=Gb;for(var g=c,h=f.length,k=[],p=[],v="",x=null,z=0;z<h;z++){var u=f[z];if('"'==u||"'"==u)x&&u!=x?v+=u:(x?x=null:x=u,v&&(p.push(v),v=""));else{if(!x){if("\r"==u||"\n"==u)u=";";if(" "==u||"\t"==u||";"==u){v&&(p.push(v),v="");";"==u&&p.length&&(k.push(p),p=[]);continue}}v+=u}}v&&p.push(v);p.length&&k.push(p);e[g]=k;Fb(c)||(d=!1)}return d?(b&&(a.disabled=!0),
!0):!1}if(d&&(g=Eb(d,c+".machine"))&&(h=g.exports)&&(h=h[e]))return h.call(g,f)?(b&&(a.disabled=!0),!0):!1;console.log("unimplemented: commandMachine('"+c+"','"+d+"','"+e+"','"+f+"')");return!1};window.enableEvents=mb;window.sendEvent=pb;})()
//# sourceMappingURL=pc8080.js.map
